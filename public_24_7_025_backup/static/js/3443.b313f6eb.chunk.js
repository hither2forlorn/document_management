"use strict";(self.webpackChunkgeneral_dms=self.webpackChunkgeneral_dms||[]).push([[3443],{86710:(e,t,a)=>{a.d(t,{A:()=>i});a(65043);var s=a(64854),n=a(45413),r=a(8586),l=a(70579);function i(e){var t,a;let{label:i,onChange:d,required:c,errors:h,object:o,options:u,isEdit:m,name:p,getFieldValue:v,...x}=e;return u=null===(t=u)||void 0===t?void 0:t.map((e=>({...e,label:null===e||void 0===e?void 0:e.name,value:(null===e||void 0===e?void 0:e[v])||(null===e||void 0===e?void 0:e.id)}))),u=null===(a=u)||void 0===a?void 0:a.map((e=>{let t="",a=null!==e&&void 0!==e&&e.level?null===e||void 0===e?void 0:e.level:0;for(;a-- >0;)t+="---";return{...e,label:t+" "+e.label}})),(0,l.jsx)(l.Fragment,{children:(0,l.jsxs)(n.A,{children:[(0,l.jsxs)(r.A,{children:[i||"",c&&(0,l.jsx)("span",{className:"text-danger h6 ml-1",children:(0,l.jsx)("b",{children:"*"})})]}),(0,l.jsx)(s.default,{...m?{value:o[p]?o[p]:""}:{},name:p,options:u,onChange:d,...x}),h?(0,l.jsx)("span",{className:"text text-danger",children:h[0]}):null]})})}},10951:(e,t,a)=>{a.d(t,{A:()=>l});var s=a(65043),n=a(86710),r=a(70579);function l(e){let{branches:t,setSelectedValues:a,selectedBranches:l}=e;const[i,d]=(0,s.useState)(null);return(0,r.jsx)("div",{children:(0,r.jsx)(n.A,{options:t,value:l,getFieldValue:"id",onChange:e=>{d(e),a(e)},isMulti:!0,getOptionLabel:e=>e.name,getOptionValue:e=>e.id})})}},13443:(e,t,a)=>{a.r(t),a.d(t,{default:()=>N});var s=a(65043),n=a(17305),r=a(58441),l=a(37519),i=a(97508),d=a(28096),c=a(87382),h=a(80231),o=a(83565),u=a(75304),m=a(38477),p=a(25852),v=a(13718),x=a(94576),g=a(44864),j=a(45413),y=a(8586),f=a(64412),A=a(83407),b=a(10951),S=a(91815),C=a(86453),B=a(70579);class E extends s.Component{constructor(e){super(e),this.state={department:{},departments:[],securityHierarchyBranches:[],selectedBranches:[],parentList:[],selectedBranchesList:[],hierarchy:[]},this.handleSelectedBranchesChange=e=>{this.setState({selectedBranchesList:e})},this.handleChange=e=>{const t=e.target.name;let a=e.target.value;const s=this.state.department;if("name"!==t){if("parentId"===t){const e=this.state.hierarchy,t=e.find((e=>e.id===Number(a)));if(t){if(t.id===e.id)return void d.oR.warn("Cannot select itself as parent!");s.securityHierarchyId=t.id,s.level=t.level+1}else s.securityHierarchyId=null,s.level=0}this.setState({department:{...s,[t]:a}})}else this.setState({department:{...s,[t]:a}})},this.handleDepartmentParentChange=e=>{const t=e.target.name;let a=e.target.value;const s=this.state.department,n=this.state.parentList.find((e=>e.id===Number(a)));if(n){if(n.id===s.id)return void d.oR.warn("Cannot select itself as parent!");s.parentId=n.id,s.level=n.level+1}else s.parentId=null,s.level=0;this.setState({department:{...s,[t]:a}})},this.handleSubmit=e=>{var t;e.preventDefault();const a=(0,C.tg)(e),s={hierarchyId:(null===(t=this.state.selectedBranchesList)||void 0===t?void 0:t.map((e=>e.id)))||[],...a,id:this.state.department.id},r=this.state.hierarchy.filter((e=>e.id===Number(s.parentId)?1:0))[0];s.level=r?r.level:0,(0,n.df)(s,((e,t)=>{e.response&&e.response.data&&e.response.data.message?d.oR.error(e.response.data.message):d.oR.success("Edited Sucessfully."),t&&(t.message?d.oR.success(t.message):d.oR.error("Unexpected response structure.")),this.props.history.push(h.A.adminDepartments),this.props.dispatch((0,l.Ni)())}))},this.handleSubmit=this.handleSubmit.bind(this),this.handleSelectedBranchesChange=this.handleSelectedBranchesChange.bind(this)}componentDidMount(){const e=o.parse(this.props.location.search),t=r.A.getId(e["?i"]);r.A.getId(this.props.match.params.id),t?((0,n.D9)(t,((e,t)=>{e||t.success&&t.data&&this.setState({department:t.data,selectedBranchesList:t.data.branches.map((e=>({id:e.branchId,name:e.branchName})))})})),(0,S.qY)(((e,t)=>{const a=null===t||void 0===t?void 0:t.filter((e=>!e.code.includes("Branch")));e||this.setState({hierarchy:a})})),(0,S.wl)(((e,t)=>{var a;const s=null===t||void 0===t||null===(a=t.branches)||void 0===a?void 0:a.filter((e=>e.code.includes("Branch")));e?console.log(e):t.success&&t.branches&&this.setState({securityHierarchyBranches:s})})),(0,n.ax)(((e,t)=>{e||this.setState({parentList:t})})),this.setState({...this.props.allFields})):window.location.replace(h.A.adminDepartments)}renderItems(){return Array.isArray(this.state.departments)&&!1!==this.state.departments.success?(0,B.jsxs)(u.A,{className:"shadow",children:[(0,B.jsx)(m.A,{children:(0,B.jsx)(p.A,{children:(0,B.jsxs)(v.A,{children:[" ",(0,B.jsx)("i",{className:"fas fa-sitemap mr-1"}),"Edit Department"]})})}),(0,B.jsxs)(x.A,{onSubmit:this.handleSubmit,children:[(0,B.jsxs)(g.A,{children:[(0,B.jsxs)(j.A,{className:"d-flex",children:[(0,B.jsx)(v.A,{md:4,children:(0,B.jsx)(y.A,{children:"Name"})}),(0,B.jsx)(v.A,{md:8,children:(0,B.jsx)(f.A,{onChange:this.handleChange,value:this.state.department.name?this.state.department.name:"",required:!0,name:"name",id:"name"})})]}),(0,B.jsxs)(j.A,{className:"d-flex",children:[(0,B.jsx)(v.A,{md:4,children:(0,B.jsx)(y.A,{children:"Security Hierarchy Parent Category"})}),(0,B.jsxs)(v.A,{md:8,children:[" ",(0,B.jsxs)(f.A,{type:"select",onChange:this.handleChange,name:"parentId",id:"parentId",value:this.state.department.securityHierarchyId?this.state.department.securityHierarchyId:"",children:[(0,B.jsx)("option",{value:"",children:"--- NONE ---"}),this.state.hierarchy.map((e=>{let t="",a=e.id,s=e.level;for(;s-- >0;)t+="---";return(0,B.jsx)("option",{value:a,children:t+" "+e.name},a)}))]})]})]}),(0,B.jsxs)(j.A,{className:"d-flex align-items-center",children:[(0,B.jsx)(v.A,{md:4,children:(0,B.jsx)(y.A,{children:"Branches"})}),(0,B.jsx)(v.A,{md:8,children:(0,B.jsx)(b.A,{branches:this.state.securityHierarchyBranches?this.state.securityHierarchyBranches:[],setSelectedValues:this.handleSelectedBranchesChange,selectedBranches:this.state.selectedBranchesList})})]})]}),(0,B.jsxs)(A.A,{className:"d-flex justify-content-end",children:[(0,B.jsx)(c.A,{onClick:()=>window.history.back(),type:"button",color:"danger",className:"mx-2 text-white",children:"Cancel"}),(0,B.jsx)(c.A,{color:"primary",children:"Update"})]})]})]}):null}render(){return this.renderItems()}}const N=(0,i.Ng)((e=>({allFields:e.allFields})))(E)},17305:(e,t,a)=>{a.d(t,{Aj:()=>c,D9:()=>l,YE:()=>i,ax:()=>r,df:()=>d});var s=a(76400);const n="/department";function r(e){s.E8.get(`${n}`).then((t=>{e(null,t.data)})).catch((t=>{e(t)}))}function l(e,t){s.E8.get(`${n}/${e}`).then((e=>{t(null,e.data)})).catch((e=>{t(e)}))}function i(e,t){s.E8.post(`${n}`,e).then((e=>{t(null,e.data)})).catch((e=>{t(e)}))}function d(e,t){s.E8.put(`${n}`,e).then((e=>{t(null,e.data)})).catch((e=>{t(e)}))}function c(e,t){s.E8.delete(`${n}/${e}`).then((e=>{t(null,e.data)})).catch((e=>{t(e)}))}},91815:(e,t,a)=>{a.d(t,{$k:()=>h,Pb:()=>d,aY:()=>o,mI:()=>i,nV:()=>u,nn:()=>c,qY:()=>r,wl:()=>l});var s=a(76400);const n="/security-hierarchy",r=e=>{s.E8.get(`${n}`).then((t=>{e(null,t.data)})).catch((t=>{e(t)}))},l=e=>{s.E8.get("/security-hierarchy-branches").then((t=>{e(null,t.data)})).catch((t=>{e(t)}))},i=(e,t)=>{s.E8.get(`${n}/${e}`).then((e=>{t(null,e.data)})).catch((e=>{t(e)}))},d=(e,t)=>{s.E8.post(`${n}`,e).then((e=>{console.log(e.data),t(null,e.data)})).catch((e=>{t(e)}))},c=e=>{s.E8.get("/branchesFilter").then((t=>{e(null,t.data)})).catch((t=>{e(t)}))},h=e=>{s.E8.get("/departmentsFilter").then((t=>{e(null,t.data)})).catch((t=>{e(t)}))},o=(e,t)=>{s.E8.put(`${n}`,e).then((e=>{t(null,e.data)})).catch((e=>{t(e)}))},u=(e,t)=>{s.E8.delete(`${n}/${e}`).then((e=>{t(null,e.data)})).catch((e=>{t(e)}))}}}]);
//# sourceMappingURL=3443.b313f6eb.chunk.js.map