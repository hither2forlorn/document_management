"use strict";(self.webpackChunkgeneral_dms=self.webpackChunkgeneral_dms||[]).push([[5208],{5208:(e,s,t)=>{t.r(s),t.d(s,{default:()=>E});var r=t(65043),n=t(75304),a=t(38477),d=t(25852),i=t(44864),l=t(62582),c=t(58441),o=t(80231),h=t(70579);const p=e=>{let{departments:s,onFilter:t}=e;if(!Array.isArray(s)||!1===s.success)return null;const[p,m]=(0,r.useState)({});(0,r.useEffect)((()=>{m({})}),[s]);const u=e=>{m((s=>({...s,[e]:!s[e]})))},x=Math.min(...s.map((e=>e.level))),f=(e=>e.reduce(((e,s)=>(e[s.parentId]||(e[s.parentId]=[]),e[s.parentId].push(s),e)),{}))(s),j=(e,s)=>(f[e]||[]).filter((e=>e.level===s)).map((e=>(0,h.jsxs)("div",{style:{marginLeft:10*(s-x),cursor:"pointer"},children:[(0,h.jsx)("i",{className:`fa ${p[e.id]?"fa-caret-down":"fa-caret-right"} mr-2`,onClick:()=>u(e.id)}),(0,h.jsxs)("span",{onClick:()=>t(e.id),children:[(0,h.jsx)("i",{className:"fa fa-folder-o mr-2"}),e.name,(0,h.jsx)(l.Link,{to:`${o.A.adminDepartmentsEdit}?i=${c.A.getHash(e.id)}`,style:{marginLeft:8},children:"[EDIT]"})]}),(0,h.jsx)("br",{}),p[e.id]&&(0,h.jsxs)(h.Fragment,{children:[e.branches&&e.branches.map((e=>(0,h.jsxs)("div",{style:{marginLeft:10*(s+1-x)},children:[(0,h.jsx)("i",{className:"fa fa-folder-open mr-2"}),e.name]},e.id))),j(e.id,s+1)]})]},e.id))),b=s.filter((e=>e.level===x));return(0,h.jsxs)(n.A,{className:"shadow",children:[(0,h.jsx)(a.A,{children:(0,h.jsxs)(d.A,{children:[(0,h.jsxs)("p",{className:"h5",children:[(0,h.jsx)("i",{className:"fas fa-building mr-1"}),"Department List"]}),(0,h.jsx)("span",{style:{cursor:"pointer"},onClick:()=>t(null),className:"btn-header btn btn-outline-dark btn-sm border-dark border",children:(0,h.jsx)("i",{className:"fa fa-refresh"})})]})}),(0,h.jsx)(i.A,{children:b.map((e=>(0,h.jsxs)("div",{style:{marginLeft:20*(e.level-x)},children:[(0,h.jsx)("i",{className:`fa ${p[e.id]?"fa-caret-down":"fa-caret-right"} mr-2`,onClick:()=>u(e.id)}),(0,h.jsxs)("span",{onClick:()=>t(e.id),children:[(0,h.jsx)("i",{className:"fa fa-folder-o mr-2"}),e.name,(0,h.jsx)(l.Link,{to:`${o.A.adminDepartmentsEdit}?i=${c.A.getHash(e.id)}`,style:{marginLeft:10},children:"[EDIT]"})]}),(0,h.jsx)("br",{}),p[e.id]&&(0,h.jsxs)(h.Fragment,{children:[e.branches&&e.branches.map((s=>(0,h.jsxs)("div",{style:{marginLeft:20*(e.level+1-x)},children:[(0,h.jsx)("i",{className:"fa fa-folder-open mr-2"}),s.name]},s.id))),j(e.id,e.level+1)]})]},e.id)))})]})};var m=t(18039),u=t(86178),x=t.n(u),f=t(46759),j=t(97508),b=(t(10577),t(11594)),A=t(58472);class g extends r.Component{render(){const e=this.props.permissions||{};return(0,h.jsxs)(n.A,{className:"shadow",children:[(0,h.jsxs)(a.A,{children:[(0,h.jsx)("p",{className:"h5",children:"Departments"}),e.department===m.Xd||e.department===m.n7?(0,h.jsxs)(l.Link,{to:o.A.adminDepartmentsAdd,className:"btn-header btn btn-outline-dark btn-sm border-dark border",children:[(0,h.jsx)("i",{className:"fa fa-plus"}),"Add Department"]}):null]}),(0,h.jsx)(i.A,{children:(0,h.jsxs)(A.A,{responsive:!0,bordered:!0,children:[(0,h.jsx)("thead",{className:"table-active",children:(0,h.jsxs)("tr",{children:[(0,h.jsx)("th",{children:"Id"}),(0,h.jsx)("th",{children:"Name"}),(0,h.jsx)("th",{children:"Created By"}),(0,h.jsx)("th",{children:"Created"}),(0,h.jsx)("th",{children:"Modified"}),(0,h.jsx)("th",{style:{width:"150px"},children:"Actions"})]})}),(0,h.jsx)("tbody",{children:this.props.departmentsOnTable.map((s=>(0,h.jsxs)("tr",{children:[(0,h.jsx)("td",{children:s.id}),(0,h.jsx)("td",{children:s.name}),(0,h.jsx)("td",{children:(0,f._W)(this.props.users,s.createdBy)}),(0,h.jsx)("td",{children:x()(s.createdAt).format("YYYY-MM-DD")}),(0,h.jsx)("td",{children:x()(s.updatedAt).format("YYYY-MM-DD")}),(0,h.jsxs)("td",{children:[e.department===m.Xd||e.department===m.n7?(0,h.jsx)(b.A,{to:o.A.adminDepartmentsEdit+"?i="+c.A.getHash(s.id),buttonType:"edit",permission:e.department}):null,(0,h.jsx)(b.A,{onClick:()=>this.props.deleteDepartment(s.id),buttonType:"delete",permission:e.department})]})]},s.id)))})]})})]})}}const v=(0,j.Ng)((e=>({users:e.allFields.users})))(g);var N=t(17305),D=t(37519),y=t(28096),k=t(13718);class T extends r.Component{constructor(e){super(e),this.state={departments:[],departmentsOnTable:[],departmentParentId:null,departmentBranchId:[]},this.deleteDepartment=e=>{window.confirm("Do you want to delete?")&&(0,N.Aj)(e,((e,s)=>{e&&this.history.push(o.A.adminDepartments),s.success?(y.oR.success("Success!"),this.updateData(),this.props.dispatch((0,D.Ni)())):y.oR.error(s.message)}))},this.onFilter=this.onFilter.bind(this)}onFilter(e,s){if(!Array.isArray(this.state.departments)||!1===this.state.departments.success)return null;const t=this.state.departments.filter((t=>null!==e?t.id===e:null===s||t.parentId===s));this.setState({departmentsOnTable:t,departmentParentId:s})}updateData(){(0,N.ax)(((e,s)=>{e||this.setState({departments:s},(()=>{this.onFilter(null,null)}))}))}componentDidMount(){this.updateData()}renderItems(){return(0,h.jsxs)(d.A,{children:[(0,h.jsx)(k.A,{md:4,children:(0,h.jsx)(p,{departments:this.state.departments,onFilter:this.onFilter,...this.props})}),(0,h.jsx)(k.A,{md:8,className:"pl-3 pl-md-0",children:(0,h.jsx)(v,{departmentsOnTable:this.state.departmentsOnTable,deleteDepartment:this.deleteDepartment,...this.props})})]})}render(){return this.renderItems()}}const E=(0,j.Ng)()(T)},17305:(e,s,t)=>{t.d(s,{Aj:()=>c,D9:()=>d,YE:()=>i,ax:()=>a,df:()=>l});var r=t(76400);const n="/department";function a(e){r.E8.get(`${n}`).then((s=>{e(null,s.data)})).catch((s=>{e(s)}))}function d(e,s){r.E8.get(`${n}/${e}`).then((e=>{s(null,e.data)})).catch((e=>{s(e)}))}function i(e,s){r.E8.post(`${n}`,e).then((e=>{s(null,e.data)})).catch((e=>{s(e)}))}function l(e,s){r.E8.put(`${n}`,e).then((e=>{s(null,e.data)})).catch((e=>{s(e)}))}function c(e,s){r.E8.delete(`${n}/${e}`).then((e=>{s(null,e.data)})).catch((e=>{s(e)}))}},58472:(e,s,t)=>{t.d(s,{A:()=>u});var r=t(58168),n=t(98587),a=t(65043),d=t(65173),i=t.n(d),l=t(98139),c=t.n(l),o=t(62373),h=["className","cssModule","size","bordered","borderless","striped","dark","hover","responsive","tag","responsiveTag","innerRef"],p={className:i().string,cssModule:i().object,size:i().string,bordered:i().bool,borderless:i().bool,striped:i().bool,dark:i().bool,hover:i().bool,responsive:i().oneOfType([i().bool,i().string]),tag:o.Wx,responsiveTag:o.Wx,innerRef:i().oneOfType([i().func,i().string,i().object])},m=function(e){var s=e.className,t=e.cssModule,d=e.size,i=e.bordered,l=e.borderless,p=e.striped,m=e.dark,u=e.hover,x=e.responsive,f=e.tag,j=e.responsiveTag,b=e.innerRef,A=(0,n.A)(e,h),g=(0,o.qO)(c()(s,"table",!!d&&"table-"+d,!!i&&"table-bordered",!!l&&"table-borderless",!!p&&"table-striped",!!m&&"table-dark",!!u&&"table-hover"),t),v=a.createElement(f,(0,r.A)({},A,{ref:b,className:g}));if(x){var N=(0,o.qO)(!0===x?"table-responsive":"table-responsive-"+x,t);return a.createElement(j,{className:N},v)}return v};m.propTypes=p,m.defaultProps={tag:"table",responsiveTag:"div"};const u=m}}]);
//# sourceMappingURL=5208.b7b0beb5.chunk.js.map