"use strict";(self.webpackChunkgeneral_dms=self.webpackChunkgeneral_dms||[]).push([[7247],{30358:(e,t,n)=>{n.d(t,{MR:()=>h,SN:()=>c,cM:()=>u,d7:()=>l,p9:()=>o,t0:()=>d,ys:()=>r});var s=n(76400);const a="/branches",i="/district";function r(e,t){s.E8.post(`${a}`,e).then((e=>e.data)).then((e=>{t(null,e)})).catch((e=>{console.log(e),t(e)}))}function o(e){s.E8.get(`${a}`).then((e=>e.data)).then((t=>{e(null,t)})).catch((t=>{console.log(t),e(t)}))}function d(e,t){s.E8.put(`${a}`,e).then((e=>e.data)).then((e=>{t(null,e)})).catch((e=>{console.log(e),t(e)}))}function l(e,t){s.E8.get(`${a}/${e}`).then((e=>e.data)).then((e=>{t(null,e)})).catch((e=>{console.log(e),t(e)}))}function h(e,t){s.E8.get(`${a}/logo/${e}`).then((e=>e.data)).then((e=>{t(null,e)})).catch((e=>{console.log(e),t(e)}))}function c(e,t){s.E8.delete(`${a}/${e}`).then((e=>e.data)).then((e=>{t(null,e)})).catch((e=>{console.log(e),t(e)}))}function u(e){s.E8.get(`${i}`).then((e=>e.data)).then((t=>{e(null,t)})).catch((t=>{console.log(t),e(t)}))}},31785:(e,t,n)=>{n.d(t,{i:()=>r,r:()=>i});var s=n(76400);const a="/tags",i=e=>{s.E8.get(`${a}`).then((e=>e.data)).then((t=>{e(null,t)})).catch((t=>e(t)))},r=e=>{s.E8.get(`${a}/suggest`).then((e=>e.data)).then((t=>{e(null,t)})).catch((t=>e(t)))}},17305:(e,t,n)=>{n.d(t,{Aj:()=>l,D9:()=>r,YE:()=>o,ax:()=>i,df:()=>d});var s=n(76400);const a="/department";function i(e){s.E8.get(`${a}`).then((t=>{e(null,t.data)})).catch((t=>{e(t)}))}function r(e,t){s.E8.get(`${a}/${e}`).then((e=>{t(null,e.data)})).catch((e=>{t(e)}))}function o(e,t){s.E8.post(`${a}`,e).then((e=>{t(null,e.data)})).catch((e=>{t(e)}))}function d(e,t){s.E8.put(`${a}`,e).then((e=>{t(null,e.data)})).catch((e=>{t(e)}))}function l(e,t){s.E8.delete(`${a}/${e}`).then((e=>{t(null,e.data)})).catch((e=>{t(e)}))}},7379:(e,t,n)=>{n.d(t,{Cm:()=>d,D3:()=>o,EO:()=>h,Lw:()=>r,O0:()=>i,cX:()=>l});var s=n(76400);const a="/roles";function i(e){s.E8.get(`${a}`).then((function(t){e(null,t.data)})).catch((function(t){e(t)}))}function r(e,t){s.E8.get(`${a}/${e}`).then((function(e){t(null,e.data)})).catch((function(e){t(e)}))}function o(e,t){s.E8.put(`${a}/${e.id}`,e).then((function(e){t(null,e.data)})).catch((function(e){t(e)}))}function d(e,t){s.E8.post(`${a}`,e).then((function(e){t(null,e.data)})).catch((function(e){t(e)}))}function l(e){s.E8.get(`${a}/types`).then((function(t){e(null,t.data)})).catch((function(t){e(t)}))}function h(e,t){s.E8.delete(`${a}/${e}`).then((function(e){t(null,e.data)})).catch((function(e){t(e)}))}},7247:(e,t,n)=>{n.r(t),n.d(t,{default:()=>w});var s=n(65043),a=n(97837),i=n(84134),r=n(58441),o=n(97508),d=n(28096),l=n(83565),h=n(80231),c=n(75304),u=n(38477),m=n(25852),p=n(13718),b=(n(15421),n(37519)),g=n(17305),v=n(7379),f=n(30358),x=(n(31785),n(70579));class j extends s.Component{constructor(e){super(e),this.handleChange=e=>{let{user:t}=this.state;const{name:n,value:s,type:a}=e.target;switch(e.target.name){case"hierarchy":const e=this.props.allFields.hierarchy.find((e=>e.code===s));"unit"===e.type?this.setState({unit:!0,security_hierarchy:s,branchId:(null===e||void 0===e?void 0:e.branchId)||null}):(this.setState({security_hierarchy:s,branchId:(null===e||void 0===e?void 0:e.branchId)||null,departmentId:(null===e||void 0===e?void 0:e.departmentId)||null}),null!==e&&void 0!==e&&e.departmentId?(t.departmentId=null===e||void 0===e?void 0:e.departmentId,t.branchId=null):null!==e&&void 0!==e&&e.branchId?(t.branchId=null===e||void 0===e?void 0:e.branchId,t.departmentId=null):(t.departmentId=t.departmentId,t.branchId=t.branchId));break;case"departmentId":this.setState({departmentId:s,branchId:s});break;case"branchId":if(this.state.unit)this.setState({[n]:s});else{const e=this.props.allFields.hierarchy.find((e=>(null===e||void 0===e?void 0:e[n])==s));t.hierarchy=(null===e||void 0===e?void 0:e.code)||this.state.security_hierarchy,this.setState({[n]:s,security_hierarchy:null===e||void 0===e?void 0:e.code})}}switch(a){case"checkbox":t[n]=e.checked;break;case"textarea":t.notes=s;break;default:"departmentId"==n?t.departmentId=s:"branchId"==n&&(t.departmentId=null),t[n]=s}this.setState({user:t})},this.handleReset=()=>{this.forceUpdate()},this.handleSubmit=e=>{if(e.preventDefault(),!window.confirm("Do you want to update the user?"))return;const t={...this.state.user};if(this.state.branchId&&(t.branchId=this.state.branchId),t.departmentId&&t.hierarchy&&t.hierarchy.startsWith("Dept_")){const e=t.hierarchy.match(/\d+$/);e&&(t.departmentId=e[0])}if(t.branchId){var n,s,a;const e=null===this||void 0===this||null===(n=this.state)||void 0===n||null===(s=n.branches)||void 0===s||null===(a=s.find((e=>e.name===t.branchId)))||void 0===a?void 0:a.id;t.branchId=e}if(t.hierarchy&&t.hierarchy.startsWith("Branch_")){const e=t.hierarchy.match(/\d+$/);e&&(t.branchId=e[0])}t.password&&!this.validatePasswordConf(t.password,t.confirmPassword)||(delete t.confirmPassword,(0,i.gw)(t,((e,t)=>{var n;return e?409===(null===e||void 0===e||null===(n=e.response)||void 0===n?void 0:n.status)?void d.oR.error(e.response.data.message):(this.setState({validationErrors:e.response.data.data}),void d.oR.error("There are some errors with the data provided.")):t.success?(this.props.dispatch((0,b.Ni)()),d.oR.success("Successful!"),void this.props.history.push(h.A.adminUsers)):d.oR.warn(t.message)})))},this.validatePasswordConf=(e,t)=>e===t||(document.getElementById("confirmPassword").focus(),d.oR.warn("Passwords do not match!"),!1),this.handleShowPassword=e=>{const t=this.state.showPassword;this.setState({showPassword:!t})},this.state={roles:[],userStatuses:[],branches:[],showPassword:!1,departments:[],hierarchy:[],departmentId:!1,userGroup:[],parentList:[],loginAttempts:[{id:3,name:"3 times"},{id:5,name:"5 times"},{id:10,name:"10 times"}],user:{},notes:null,validationErrors:{}}}componentDidMount(){const e=l.parse(this.props.location.search),t=r.A.getId(e["?i"]);t||this.props.history.push(h.A.adminUsers),(0,i.wz)(t,((e,t)=>{e||this.setState({user:t.user})})),(0,g.ax)(((e,t)=>{e||this.setState({parentList:t})})),(0,v.O0)(((e,t)=>{e||this.setState({roles:t})})),(0,f.p9)(((e,t)=>{e||this.setState({branches:t.data})})),this.setState(this.props.allFields)}render(){return(0,x.jsxs)(c.A,{className:"shadow",children:[(0,x.jsx)(u.A,{children:(0,x.jsx)(m.A,{children:(0,x.jsxs)(p.A,{children:[(0,x.jsx)("i",{className:"fa fa-user mr-1"}),this.props.name]})})}),(0,x.jsx)(a.A,{validationErrors:this.state.validationErrors?this.state.validationErrors:null,user:this.state.user,onReset:this.handleReset,onChange:this.handleChange,onShowPassword:this.handleShowPassword,onSubmit:this.handleSubmit,isEdit:!0,...this.props,...this.state})]})}}const w=(0,o.Ng)((e=>({allFields:e.allFields})))(j)},97837:(e,t,n)=>{n.d(t,{A:()=>v});n(65043);var s=n(19368),a=n(18039),i=n(96541),r=n(10810),o=n(97956),d=n(44864),l=n(25852),h=n(13718),c=n(83407),u=n(15421),m=n(97508),p=(n(6207),n(76400),n(28344)),b=n(70579);const g=[{id:3,name:"3 times"},{id:5,name:"5 times"},{id:10,name:"10 times"}],v=e=>{var t,n,v;const f=null===e||void 0===e?void 0:e.isEdit,x=e.user?null===e||void 0===e?void 0:e.user:{},j=null!==e&&void 0!==e&&e.permissions?e.permissions:{},w=null!==e&&void 0!==e&&e.validationErrors?null===e||void 0===e?void 0:e.validationErrors:null,y=1===(0,m.d4)((e=>e.userProfile)).id,E=null===e||void 0===e||null===(t=e.security_hierarchy)||void 0===t?void 0:t.slice(e.security_hierarchy.length-1),I=null===e||void 0===e||null===(n=e.parentList)||void 0===n?void 0:n.find((e=>String(e.id)===E));null===I||void 0===I||null===(v=I.branches)||void 0===v||v.map((e=>({id:e.hirarchybranchId,name:e.name})));return(0,b.jsxs)("form",{id:"signup-form",onReset:e.onReset,onSubmit:e.onSubmit,children:[(0,b.jsx)(d.A,{children:(0,b.jsxs)(l.A,{children:[(0,b.jsx)(h.A,{md:3,children:(0,b.jsx)(s.wi,{required:!0,onInput:e=>(0,p.P)(e.target),onChange:e.onChange,label:"Identity Number",disabled:!y&&f,name:"identityNo",object:x,isEdit:f,errors:null===w||void 0===w?void 0:w.identityNo})}),(0,b.jsx)(h.A,{md:3,children:(0,b.jsx)(s.wi,{onInput:e=>(0,p.P)(e.target),onChange:e.onChange,label:"Email",disabled:!y&&f,required:!0,name:"email",object:x,type:"email",isEdit:f,errors:null===w||void 0===w?void 0:w.email})}),(0,b.jsx)(h.A,{md:3,children:(0,b.jsx)(s.wi,{onChange:e.onChange,label:"Full Name",onInput:e=>(0,p.P)(e.target),name:"name",required:!0,disabled:!y&&f,object:x,isEdit:f,errors:null===w||void 0===w?void 0:w.name})}),(0,u.excludeThisVendor)(u.banks.bok.name)&&(0,b.jsx)(h.A,{md:3,children:(0,b.jsx)(s.Ae,{onChange:e.onChange,label:"Gender",name:"gender",object:x,options:[{id:"male",name:"Male"},{id:"female",name:"Female"},{id:"other",name:"Other"}],isEdit:f,errors:w?w.gender:null})}),(0,u.excludeThisVendor)(u.banks.bok.name)&&(0,b.jsx)(h.A,{md:3,children:(0,b.jsx)(s.wi,{onChange:e.onChange,label:"Date of Birth",name:"dateOfBirth",type:"date",object:x,isEdit:f,errors:w?w.dateOfBirth:null})}),(0,u.excludeThisVendor)(u.banks.bok.name)&&(0,b.jsx)(h.A,{md:3,children:(0,b.jsx)(s.wi,{onChange:e.onChange,label:"Phone Number",onInput:e=>(0,p.P)(e.target),name:"phoneNumber",object:x,errors:null===w||void 0===w?void 0:w.phoneNumber,isEdit:f})}),(0,b.jsx)(h.A,{md:3,children:(0,b.jsx)(s.wi,{onChange:e.onChange,label:"Designation",errors:null===w||void 0===w?void 0:w.designation,name:"designation",object:x,onInput:e=>(0,p.P)(e.target),isEdit:f})}),j.user>=a.Xd?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(h.A,{md:3,children:(0,b.jsx)(s.wi,{onChange:e.onChange,label:"Expiry Date",name:"expiryDate",object:x,type:"date",isEdit:f,errors:w?w.expiryDate:null})}),(0,b.jsx)(h.A,{md:3,children:(0,b.jsx)(s.Ae,{required:!0,onChange:e.onChange,label:"Role",name:"roleId",object:x,options:e.allFields.roles,isEdit:f,errors:w?w.roleId:null})}),(0,b.jsx)(h.A,{md:3,children:(0,b.jsx)(s.Ae,{required:!0,label:"Security Hierarchy",name:"hierarchy",onChange:e.onChange,object:x,defaultValueOnlyForCombobox:null===e||void 0===e?void 0:e.security_hierarchy,options:e.allFields.hierarchy,isEdit:f,errors:w?w.hierarchy:null})}),(0,b.jsx)(h.A,{md:3,children:(0,b.jsx)(s.Ae,{required:!0,onChange:e.onChange,label:"Login Attempts",name:"loginAttempts",object:x,options:g,defaultValue:10,isEdit:f,errors:w?w.loginAttempts:null})}),(0,b.jsx)(h.A,{md:3,children:(0,b.jsx)(s.Ae,{required:!0,onChange:e.onChange,label:"Status",name:"statusId",object:x,defaultValue:1,options:e.userStatuses,isEdit:f,errors:w?w.statusId:null})})]}):null,(0,b.jsx)(h.A,{md:12,children:(0,b.jsxs)(l.A,{children:[(0,b.jsx)(h.A,{md:3,children:(0,b.jsx)(s.wi,{onChange:e.onChange,label:"New Password",name:"password",type:e.showPassword?"text":"password",object:x,isEdit:f,errors:w.password})}),(0,b.jsx)(h.A,{md:3,children:(0,b.jsx)(s.wi,{onChange:e.onChange,label:"Confirm Password",name:"confirmPassword",type:e.showPassword?"text":"password",object:x,isEdit:f})}),(0,b.jsx)(h.A,{md:3,className:"d-flex justify-content-center align-items-center",children:(0,b.jsx)(s.wi,{onChange:e.onShowPassword,name:"showPassword",type:"checkbox",children:"show passwords"})})]})}),(0,b.jsx)(h.A,{md:12,children:(0,b.jsx)(s.wi,{isEdit:f,object:x,label:"Notes",name:"notes",type:"textarea",onChange:e.onChange})})]})}),(0,b.jsx)(c.A,{className:"d-flex justify-content-end",children:f?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("button",{className:"mx-2 btn btn-info text-white",type:"button",onClick:()=>e.history.push(i.A.adminUsers),children:"Cancel"}),(0,b.jsx)("button",{className:"btn btn-success",type:"submit",children:"Update"})]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(o.A,{onClick:()=>window.history.back()}),(0,b.jsx)(r.A,{isDisabled:e.isDisabled})]})})]})}},28344:(e,t,n)=>{n.d(t,{P:()=>s});const s=e=>{/^\s/.test(e.value)&&(e.value="")}}}]);
//# sourceMappingURL=7247.f9179f1c.chunk.js.map