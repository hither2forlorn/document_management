"use strict";(self.webpackChunkgeneral_dms=self.webpackChunkgeneral_dms||[]).push([[2124],{92124:(e,t,n)=>{n.r(t),n.d(t,{default:()=>b});var a=n(65043),s=n(40832),o=n.n(s),l=n(76400),c=n(58441),i=n(40575),d=n(75304),r=n(38477),h=n(25852),m=n(13718),u=n(45413),p=n(8586),f=n(64412),g=n(44864),w=n(83407),A=n(97956),x=n(80231),y=n(28096),j=n(3770),I=n(70579);const b=e=>{let t=document.getElementById("file-viewer");const[n,s]=(0,a.useState)([{}]),[b,v]=(0,a.useState)([{}]),[k,E]=(0,a.useState)(!0),[N,F]=(0,a.useState)("");let S=e.location.state.selectedAttachmentId;return o()({path:"./lib",initialDoc:"",fullAPI:!0,enableRedaction:!0,documentType:"pdf"},t).then((t=>{!function(e){e.enableElements(["bookmarksPanel","bookmarksPanelButton"]),e.enableFeatures([e.Feature.Measurement])}(t);c.A.getId(e.location.hash.slice(1));document.getElementById("select").onchange=e=>{let n=e.target.options[e.target.selectedIndex].attributes.fileId.value;(0,i.gy)(n,((e,n)=>{if(!e)if(n.success){const e=l.UB+"/"+n.filePath;t.loadDocument(e)}else window.alert(n.message)}))};const{docViewer:n,annotManager:a,CoreControls:s,Annotations:o}=t;n.on("documentLoaded",(()=>{const e=new o.RedactionAnnotation;a.addAnnotation(e),a.drawAnnotationsFromList(e)})),t.setHeaderItems((t=>{t.push({type:"actionButton",img:"icon-chevron-right",onClick:async()=>{const t={xfdfString:await a.exportAnnotations(),flags:s.SaveOptions.LINEARIZED,downloadType:"pdf"},o=n.getDocument(),c=o.filename,i=await o.getFileData(t),d=new Blob([i],{type:"application/pdf"}),r=new FormData;for(var h of(r.append("fileType",t.downloadType),r.append("itemId",N.itemId),r.append("itemType","document"),r.append("redaction",k),r.append("file",d,c),r))console.log(h);l.E8.post("/attachment",r).then((t=>{e.history.push(x.A.documentsView+"?i="+e.location.hash.slice(1)+"&type=redact"),y.oR.success("successfully redacted")})).catch((e=>console.log(e)))}})}))})).catch((e=>console.log(e))),(0,a.useEffect)((()=>{(0,j.fv)(S,((e,t)=>{e&&console.log(e),F(t)})),(()=>{let t=c.A.getId(e.location.hash.slice(1));t&&(0,i.YE)("",t,((e,t)=>{t.success&&(s(t.data),v(t.data.attachments?t.data.attachments:[]))}))})()}),[]),(0,I.jsx)(I.Fragment,{children:(0,I.jsxs)(d.A,{className:"shadow",children:[(0,I.jsxs)(r.A,{children:[" ",(0,I.jsx)(h.A,{children:(0,I.jsx)(m.A,{children:(0,I.jsxs)(u.A,{children:[(0,I.jsx)(p.A,{children:"Select Files"}),(0,I.jsxs)(f.A,{id:"select",type:"select",className:"w-50",children:[(0,I.jsx)("option",{children:"--NONE--"}),(0,I.jsx)("option",{value:N.filePath,name:N.name,fileId:Number(N.id),children:N.name})]})]})})})]}),(0,I.jsx)(g.A,{children:(0,I.jsx)("div",{className:"webviewer",id:"file-viewer",style:{height:"100vh"}})}),(0,I.jsx)(w.A,{className:"d-flex justify-content-end",children:(0,I.jsx)(A.A,{onClick:()=>window.history.back()})})]})})}}}]);
//# sourceMappingURL=2124.e8efabeb.chunk.js.map