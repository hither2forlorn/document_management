"use strict";(self.webpackChunkgeneral_dms=self.webpackChunkgeneral_dms||[]).push([[7593],{17305:(e,t,a)=>{a.d(t,{Aj:()=>c,D9:()=>r,YE:()=>l,ax:()=>i,df:()=>h});var n=a(76400);const s="/department";function i(e){n.E8.get(`${s}`).then((t=>{e(null,t.data)})).catch((t=>{e(t)}))}function r(e,t){n.E8.get(`${s}/${e}`).then((e=>{t(null,e.data)})).catch((e=>{t(e)}))}function l(e,t){n.E8.post(`${s}`,e).then((e=>{t(null,e.data)})).catch((e=>{t(e)}))}function h(e,t){n.E8.put(`${s}`,e).then((e=>{t(null,e.data)})).catch((e=>{t(e)}))}function c(e,t){n.E8.delete(`${s}/${e}`).then((e=>{t(null,e.data)})).catch((e=>{t(e)}))}},37593:(e,t,a)=>{a.r(t),a.d(t,{default:()=>O});var n=a(65043),s=a(91815),i=a(86453),r=a(37519),l=a(97508),h=a(28096),c=a(80231),d=a(97956),p=a(10810),m=a(75304),u=a(38477),o=a(25852),g=a(13718),v=a(94576),S=a(44864),b=a(45413),x=a(8586),f=a(64412),A=a(83407),N=a(17305),y=a(64854),j=a(70579);class D extends n.Component{constructor(e){super(e),this.MultiSelectChange=(e,t)=>{let{action:a,removedValue:n}=t;switch(a){case"remove-value":default:break;case"pop-value":if(n&&n.isFixed)return;break;case"clear":e=this.state.branchSelect.filter((e=>e.isFixed))}this.setState({branchSelectedOptions:e})},this.departmentMultiSelectChange=(e,t)=>{let{action:a,removedValue:n}=t;switch(a){case"remove-value":default:break;case"pop-value":if(n&&n.isFixed)return;break;case"clear":e=this.state.departmentSelect.filter((e=>e.isFixed))}this.setState({departmentSelectedOptions:e})},this.handleSubmit=e=>{e.preventDefault();let t=(0,i.tg)(e);const a=this.state.hierarchy.find((e=>e.id==t.parentId));t.level=a?a.level+1:0,this.state.departmentValue&&("Unit_"==this.state.findUnitOrDept?(t.name=`Unit${this.state.hierarchyName?"_"+this.state.hierarchyName.replace(/ /g,""):""}${this.state.departmentName?"_"+this.state.departmentName:""}`,t.type="unit"):(t.type="department",t.name="Dept_"+this.state.departmentName)),this.state.branchSelectedOptions&&this.state.branchSelectedOptions.length>0&&(t={branchData:this.state.branchSelectedOptions,level:t.level,parentId:t.parentId,type:"branch"}),this.state.departmentSelectedOptions&&this.state.departmentSelectedOptions.length>0&&(t={name:`Unit${this.state.hierarchyName?"_"+this.state.hierarchyName.replace(/ /g,""):""}${this.state.departmentName?"_"+this.state.departmentName:""}`,code:"unit_"+this.state.departmentValue,multipleHierarchy:!0,departmentId:this.state.departmentValue,departmentData:this.state.departmentSelectedOptions,level:t.level,parentId:t.parentId,type:"unit"}),(0,s.Pb)(t,((e,t)=>{e||!t.success?h.oR.error((null===t||void 0===t?void 0:t.message)||"Error"):(h.oR.success((null===t||void 0===t?void 0:t.message)||"Successful"),this.props.history.push(c.A.adminSecurityHierarchy),this.props.dispatch((0,r.Ni)()))}))},this.handleProvinceunitChange=e=>{let t;this.setState({provinceUnit:e.target.value,departmentAndNameToggle:!1,hierarchyName:"",departmentValue:"",departmentName:""}),t="Dept_"==e.target.value?"Dept_":"Unit_",this.setState({departmentAndNameToggle:!0,findUnitOrDept:t}),"Dept_"!=e.target.value&&"Unit_"!=e.target.value||this.setState({departmentAndNameToggle:!0})},this.handleNameChange=e=>{this.setState({hierarchyName:e.target.value})},this.handleChangeUnitDepartment=e=>{this.setState({departmentValue:e.target.value,departmentName:e.target.value})},this.handleDepartmentChange=e=>{const t=this.state.parentList.find((t=>t.id==e.target.value));this.setState({departmentValue:e.target.value,departmentName:t.name})},this.handleBranchAndDepartment=e=>{const t=this.state.hierarchy.filter((e=>e.branchId?parseInt(e.branchId):null)),a=parseInt(e.target.value);t.map((e=>parseInt(e.id))).includes(a)?this.setState({toggleBranchAndDepartmentOption:!this.state.toggleBranchAndDepartmentOption}):this.setState({toggleBranchAndDepartmentOption:!1})},this.handleSubmit=this.handleSubmit.bind(this),this.state={branches:[],hierarchy:[],branchSelect:[],departmentSelect:[],branchSelectedOptions:[],departmentSelectedOptions:[],filterBranch:[],filterDepartment:[],provinceUnit:"",hierarchyName:"",departmentAndNameToggle:!1,departments:[],departmentValue:"",departmentName:"",findUnitOrDept:"",toggleBranchAndDepartmentOption:!1,parentList:[]}}componentDidMount(){this.setState(this.props.allFields,(()=>{const e=[],t=[];this.setState({filterBranch:(0,s.nn)(((t,a)=>{t||a.forEach((t=>{const a={value:t.id,label:t.name};e.push(a)}))})),filterDepartment:(0,s.$k)(((e,a)=>{e||a.forEach((e=>{const a={value:e.id,label:e.name};t.push(a)}))}))}),(0,N.ax)(((e,t)=>{e||this.setState({parentList:t})})),this.setState({branchSelect:e,departmentSelect:t})}))}renderItems(){var e;this.state.hierarchy.filter((e=>null!=e.departmentId)),this.state.findUnitOrDept;this.state.provinceUnit,this.state.departmentValue,this.state.hierarchyName&&this.state.hierarchyName.replace(/ /g,"");this.state.departmentSelect,this.state.branchSelect;return(0,j.jsxs)(m.A,{className:"shadow",children:[(0,j.jsx)(u.A,{children:(0,j.jsx)(o.A,{children:(0,j.jsxs)(g.A,{children:[(0,j.jsx)("i",{className:"fas fa-sitemap mr-1"}),"Add Security Hierarchy"]})})}),(0,j.jsxs)(v.A,{onSubmit:this.handleSubmit,children:[(0,j.jsxs)(S.A,{children:[(0,j.jsx)(o.A,{children:(0,j.jsx)(g.A,{children:(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(b.A,{children:(0,j.jsxs)(o.A,{children:[(0,j.jsx)(g.A,{md:4,children:(0,j.jsxs)(x.A,{children:["Parent Group",(0,j.jsx)("span",{className:"text-danger h6 ml-1",children:(0,j.jsx)("b",{children:"*"})})]})}),(0,j.jsx)(g.A,{md:8,children:(0,j.jsxs)(f.A,{type:"select",name:"parentId",id:"parentId",required:!0,onClick:e=>this.handleBranchAndDepartment(e),children:[(0,j.jsx)("option",{value:"",children:"--- NONE ---"}),this.state.hierarchy.map((e=>{let t="",a=e.level;for(;a-- >0;)t+="---";return(0,j.jsx)("option",{value:e.id,children:t+" "+e.name},e.id)}))]})})]})}),""==(null===(e=this.state)||void 0===e?void 0:e.provinceUnit)&&(0,j.jsx)(b.A,{children:(0,j.jsxs)(o.A,{children:[(0,j.jsx)(g.A,{md:4,children:(0,j.jsx)(x.A,{children:"Branch"})}),(0,j.jsx)(g.A,{md:8,children:(0,j.jsx)(y.default,{isMulti:!0,onChange:this.MultiSelectChange,value:this.state.branchSelectedOptions,name:"branchList",options:this.state.branchSelect,className:"basic-multi-select react-select-style",classNamePrefix:"select",isDisabled:this.disabled})})]})})]})})})," "]}),(0,j.jsxs)(A.A,{className:"d-flex justify-content-end",children:[(0,j.jsx)(d.A,{onClick:()=>window.history.back()}),(0,j.jsx)(p.A,{})]})]})]})}render(){return this.renderItems()}}const O=(0,l.Ng)((e=>({allFields:e.allFields})))(D)},91815:(e,t,a)=>{a.d(t,{$k:()=>d,Pb:()=>h,aY:()=>p,mI:()=>l,nV:()=>m,nn:()=>c,qY:()=>i,wl:()=>r});var n=a(76400);const s="/security-hierarchy",i=e=>{n.E8.get(`${s}`).then((t=>{e(null,t.data)})).catch((t=>{e(t)}))},r=e=>{n.E8.get("/security-hierarchy-branches").then((t=>{e(null,t.data)})).catch((t=>{e(t)}))},l=(e,t)=>{n.E8.get(`${s}/${e}`).then((e=>{t(null,e.data)})).catch((e=>{t(e)}))},h=(e,t)=>{n.E8.post(`${s}`,e).then((e=>{console.log(e.data),t(null,e.data)})).catch((e=>{t(e)}))},c=e=>{n.E8.get("/branchesFilter").then((t=>{e(null,t.data)})).catch((t=>{e(t)}))},d=e=>{n.E8.get("/departmentsFilter").then((t=>{e(null,t.data)})).catch((t=>{e(t)}))},p=(e,t)=>{n.E8.put(`${s}`,e).then((e=>{t(null,e.data)})).catch((e=>{t(e)}))},m=(e,t)=>{n.E8.delete(`${s}/${e}`).then((e=>{t(null,e.data)})).catch((e=>{t(e)}))}}}]);
//# sourceMappingURL=7593.473c9d6f.chunk.js.map