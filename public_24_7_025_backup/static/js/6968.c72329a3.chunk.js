"use strict";(self.webpackChunkgeneral_dms=self.webpackChunkgeneral_dms||[]).push([[6968],{66968:(e,t,n)=>{n.r(t),n.d(t,{default:()=>E});var a=n(65043),s=n(30358),i=n(58441),h=n(28096),r=n(87382),c=n(80231),o=n(83565),l=n(75304),d=n(38477),b=n(44864),u=n(25852),g=n(13718),m=n(8586),p=n(64412),j=n(83407),x=n(19368),A=n(15421),C=n(97508),f=n(19423),y=n(70579);class w extends a.Component{constructor(){super(...arguments),this.state={branch:{},districts:[]},this.handleChange=e=>{const t=e.target.name;let n=e.target.value;if(this.state.branch[e.target.name]=e.target.value,"name"==t&&(n=(0,f.A)(n)),this.setState({branch:{...this.state.branch,[t]:n}}),n.length>=3&&(0,A.onlyForThisVendor)(A.banks.citizen.name))return h.oR.error("Branch Code can only be 3 digits")},this.handleSubmit=e=>{e.preventDefault();const t=e.target;if(!t.checkValidity())return void h.oR.error("Please fill in all required fields correctly.");const n=t.mailId;/^[a-zA-Z0-9._%+-]+@epf\.org\.np$/.test(n.value)?window.confirm("Do you want to update the branch?")&&this.parseBranchLogo((e=>{if(e){const t=this.state.branch;t.branchLogo=e,this.setState({branch:t})}(0,s.t0)(this.state.branch,((e,t)=>{e?h.oR.error(e.response.data.message):(t.success&&h.oR.success(t.message),this.props.history.push(c.A.adminBranches))}))})):h.oR.error("Please enter a valid email address with @epf.org.np domain")}}componentDidMount(){const e=o.parse(this.props.location.search),t=i.A.getId(e["?i"]);i.A.getId(this.props.match.params.id),(0,s.d7)(t,((e,t)=>{e||t.success&&this.setState({branch:t.data},(()=>{console.log("edit branch details: ",this.state.hierarchy)}))})),this.updateData()}parseBranchLogo(e){var t=document.getElementById("branchLogo").files;if(t.length>0){var n=t[0],a=new FileReader;a.onload=function(t){var n=t.target.result;e(n)},a.readAsDataURL(n)}else e("NULL")}updateData(){(0,s.cM)(((e,t)=>{e||t.success&&this.setState({districts:t.data})}))}render(){return(0,y.jsxs)(l.A,{className:"shadow",children:[(0,y.jsx)(d.A,{children:(0,y.jsx)("p",{className:"h5",children:"Edit Branch"})}),(0,y.jsxs)("form",{onSubmit:this.handleSubmit,children:[(0,y.jsx)(b.A,{children:(0,y.jsxs)(u.A,{children:[(0,y.jsx)(g.A,{md:3,children:(0,y.jsx)(x.wi,{required:!0,object:this.state.branch,isEdit:!0,label:"Name:",name:"name",onChange:this.handleChange})}),(0,y.jsx)(g.A,{md:3,children:(0,y.jsx)(x.wi,{required:!0,object:this.state.branch,isEdit:!0,label:"Address:",name:"street",onChange:this.handleChange})}),(0,y.jsx)(g.A,{md:3,children:(0,y.jsx)(x.Ae,{object:this.state.branch,isEdit:!0,label:"District:",options:this.props.districts,name:"city",onChange:this.handleChange})}),(0,y.jsx)(g.A,{md:3,children:(0,y.jsx)(x.wi,{required:!0,object:this.state.branch,isEdit:!0,label:"Branch Code:",name:"branchCode",maxLength:(0,A.onlyForThisVendor)(A.banks.citizen.name)?3:null,onChange:this.handleChange})}),(0,A.excludeThisVendor)([A.banks.rbb.name,A.banks.citizen.name,A.banks.epf.name])&&(0,y.jsx)(g.A,{md:3,children:(0,y.jsx)(x.wi,{required:!0,object:this.state.branch,isEdit:!0,label:"SOL branch id:",name:"branchNumber",onChange:this.handleChange})}),(0,y.jsx)(g.A,{md:3,children:(0,y.jsx)(x.Ae,{object:this.state.branch,isEdit:!0,label:"Province:",name:"province",options:this.props.provinces,onChange:this.handleChange})}),(0,y.jsx)(g.A,{md:3,children:(0,y.jsx)(x.wi,{required:!0,disabled:!0,object:this.state.branch,isEdit:!0,label:"Country:",name:"country",onChange:this.handleChange})}),(0,y.jsx)(g.A,{md:3,children:(0,y.jsx)(x.wi,{object:this.state.branch,isEdit:!0,label:"Contact:",name:"phoneNumber",onChange:this.handleChange})}),(0,y.jsx)(g.A,{md:3,children:(0,y.jsx)(x.wi,{object:this.state.branch,isEdit:!0,label:"Mail Id:",name:"mailId",onChange:this.handleChange})}),(0,y.jsxs)(g.A,{md:3,children:[(0,y.jsx)(m.A,{children:"Branch Logo: "}),(0,y.jsx)(p.A,{type:"file",name:"branchLogo",id:"branchLogo"})]})]})}),(0,y.jsxs)(j.A,{className:"d-flex justify-content-end",children:[(0,y.jsx)(r.A,{onClick:()=>window.history.back(),type:"button",color:"danger",className:"mx-2 text-white",children:"Cancel"}),(0,y.jsx)(r.A,{type:"submit",color:"primary",children:"Update"})]})]})]})}}const E=(0,C.Ng)((e=>({...e.allFields})))(w)},30358:(e,t,n)=>{n.d(t,{MR:()=>l,SN:()=>d,cM:()=>b,d7:()=>o,p9:()=>r,t0:()=>c,ys:()=>h});var a=n(76400);const s="/branches",i="/district";function h(e,t){a.E8.post(`${s}`,e).then((e=>e.data)).then((e=>{t(null,e)})).catch((e=>{console.log(e),t(e)}))}function r(e){a.E8.get(`${s}`).then((e=>e.data)).then((t=>{e(null,t)})).catch((t=>{console.log(t),e(t)}))}function c(e,t){a.E8.put(`${s}`,e).then((e=>e.data)).then((e=>{t(null,e)})).catch((e=>{console.log(e),t(e)}))}function o(e,t){a.E8.get(`${s}/${e}`).then((e=>e.data)).then((e=>{t(null,e)})).catch((e=>{console.log(e),t(e)}))}function l(e,t){a.E8.get(`${s}/logo/${e}`).then((e=>e.data)).then((e=>{t(null,e)})).catch((e=>{console.log(e),t(e)}))}function d(e,t){a.E8.delete(`${s}/${e}`).then((e=>e.data)).then((e=>{t(null,e)})).catch((e=>{console.log(e),t(e)}))}function b(e){a.E8.get(`${i}`).then((e=>e.data)).then((t=>{e(null,t)})).catch((t=>{console.log(t),e(t)}))}},19423:(e,t,n)=>{function a(e){return e.charAt(0).toUpperCase()+e.slice(1)}n.d(t,{A:()=>a})}}]);
//# sourceMappingURL=6968.c72329a3.chunk.js.map