"use strict";(self.webpackChunkgeneral_dms=self.webpackChunkgeneral_dms||[]).push([[5350],{10459:(e,t,s)=>{s.r(t),s.d(t,{default:()=>k});var a=s(65043),i=s(40575),n=s(58441),h=s(53536),c=s.n(h),d=s(8325),r=s(97508),l=s(83565),o=s(80231),u=s(28096),p=s(8586),m=s(64412),g=s(75304),v=s(94576),S=s(38477),x=s(44864),y=s(87382),C=s(80043),b=(s(55863),s(70579));class A extends a.Component{constructor(e){super(e),this.state={document:{},documentData:{},documentTypes:[],languages:[],documentConditions:[],statuses:[],locationMaps:[],departments:[],users:[],securityLevels:[],yesNo:["Yes","No"],docTags:[],securityLevelCheck:0,authorizedUsersSelect:[],userAccessSelectedOptions:[],indexValues:[],validationErrors:{},tagsValue:[],hasEncryption:!1,hasOtp:!1,hasQuickQcr:!1,isArchived:!1,concate:{},concatString:"",userGroup:[]},this.handleChangeConcate=e=>{let t="";const s={...this.state.concate,...e},a=Object.entries(s);a.map(((e,s)=>{let[i,n]=e;t+=""+(0!=s&&a.length>1?"-":"")+n})),this.setState({concatString:t,concate:s,documentData:{...this.state.documentData,otherTitle:t}})},this.handleChange=e=>{var t;if((null===e||void 0===e?void 0:e.length)>=0)return;const s=e.target.name;let a=e.target.value;"documentTypeId"==(null===e||void 0===e||null===(t=e.target)||void 0===t?void 0:t.name)&&this.setState({concatString:""}),this.setState({document:{...this.state.document,[s]:a}});const i=this.state.documentData;if(i.userAccess=this.state.userAccessSelectedOptions,i[s]=a,"checkbox"===e.target.type)switch(a=e.target.checked,s){case"hasEncryption":this.setState({hasEncryption:!this.state.hasEncryption});break;case"hasOtp":this.setState({hasOtp:!this.state.hasOtp});break;case"hasQuickQcr":this.setState({hasQuickQcr:!this.state.hasQuickQcr});break;case"isArchived":this.setState({isArchived:!this.state.isArchived})}else this.setState({[s]:a});this.setState({documentData:i},(()=>{if("securityLevel"===s){const e=c().find(this.state.securityLevels,(e=>e.id===Number(a)));e?this.setState({securityLevelCheck:e.value}):this.setState({securityLevelCheck:0})}}))},this.handleSubmit=e=>{if(e.preventDefault(),window.confirm("Do you want to update the document?")){const e=this.state.documentData;e.userAccess=this.state.userAccessSelectedOptions,e.tags=this.state.tagsValue,e.document_index_values=this.state.indexValues,e.hasEncryption=this.state.hasEncryption,e.hasOtp=this.state.hasOtp,e.hasQuickQcr=this.state.hasQuickQcr,e.isArchived=this.state.isArchived,(0,i.y4)(e,((e,t)=>{e?(this.setState({validationErrors:e.response.data.data}),u.oR.error(e.response.data.message)):null!==t&&void 0!==t&&t.success?(u.oR.success(t.message),window.history.back()):u.oR.error(null===t||void 0===t?void 0:t.message)}))}},this.setIndexValues=e=>{this.setState({indexValues:e})},this.handleSubmit=this.handleSubmit.bind(this),this.loadSelect=this.loadSelect.bind(this),this.loadIndexList=this.loadIndexList.bind(this),this.handleSelectChange=this.handleSelectChange.bind(this),this.handleChange=this.handleChange.bind(this),this.handleChangeTags=this.handleChangeTags.bind(this)}loadSelect(){const e=this.state.documentData.document_access_users,t=[],s=[];this.state.users.forEach((a=>{const i=this.state.departments.filter((e=>e.id===a.departmentId?1:0))[0];let n;n=i?a.name+" - "+i.name:a.name;const h={value:a.id,label:n};e.length!==s.length&&e.forEach((e=>{e.userId===h.value&&s.push(h)})),t.push(h)})),this.setState({authorizedUsersSelect:t,userAccessSelectedOptions:s})}loadIndexList(){this.state.indexListData.map((e=>{this.state.indexTypeData.map((t=>{if(e.documentIndexId===t.id)return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(p.A,{children:t.label}),(0,b.jsx)(m.A,{type:"text",value:e.value})]})}))}))}componentDidMount(){const e=l.parse(this.props.location.search),t=n.A.getId(e["?i"]);this.setState(this.props.allFields),(0,i.YE)("",Number(t),((e,t)=>{e?this.props.history.push(o.A.documentsList):t.success?this.setState({securityLevelCheck:t.data.securityLevel,documentData:t.data,docTags:t.docTags||[],indexListData:t.data.document_index_values,indexTypeData:t.data.document_indices,hasEncryption:t.data.hasEncryption,hasOtp:t.data.hasOtp,hasQuickQcr:t.data.hasQuickQcr,isArchived:t.data.isArchived},(()=>{this.loadSelect()})):(window.alert("Unsuccessful! Not allowed to access this document."),window.location.back())}))}handleSelectChange(e,t){let{action:s,removedValue:a}=t;switch(s){case"remove-value":case"pop-value":if(a.isFixed)return;break;case"clear":e=this.state.authorizedUsersSelect.filter((e=>e.isFixed))}this.setState({userAccessSelectedOptions:e})}handleChangeTags(e){this.setState({tagsValue:e})}renderItems(){return(0,b.jsx)(g.A,{className:"shadow",children:(0,b.jsxs)(v.A,{onSubmit:this.handleSubmit,children:[(0,b.jsx)(S.A,{children:(0,b.jsxs)("p",{className:"h5",children:[(0,b.jsx)("i",{className:"fa fa-pencil"})," Edit Document"]})}),(0,b.jsxs)(x.A,{children:[this.state.documentData&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(C.A,{...this.props,setIndexValues:this.setIndexValues,handleDocumentTypeChange:this.handleChange,documentTypeId:this.state.documentData.documentTypeId,concateValue:this.handleChangeConcate,indexValues:this.state.documentData.document_index_values}),(0,b.jsx)(d.A,{validationErrors:this.state.validationErrors?this.state.validationErrors:null,handleChange:this.handleChange,handleChangeTags:this.handleChangeTags,handleSelectChange:this.handleSelectChange,isEdit:!0,...this.state,...this.props})]}),(0,b.jsx)("div",{className:"dropdown-divider"}),(0,b.jsx)("div",{className:"text-right",children:(0,b.jsx)(y.A,{type:"submit",color:"primary",children:"Update"})})]})]})})}render(){return this.renderItems()}}const k=(0,r.Ng)((e=>({allFields:e.allFields})))(A)}}]);
//# sourceMappingURL=5350.fe1ec217.chunk.js.map