"use strict";(self.webpackChunkgeneral_dms=self.webpackChunkgeneral_dms||[]).push([[107,2124],{29416:(e,t,s)=>{s.r(t),s.d(t,{default:()=>xe});var a=s(65043),i=s(25852),r=s(13718),n=s(77825),l=s(52302),c=s(94329),o=s(20670),d=s(62129),h=s(98139),m=s.n(h),u=s(40575),x=s(58441),p=s(53536),j=s.n(p),g=s(97508),A=s(28096),f=s(94576),v=s(75304),k=s(38477),b=s(44864),y=s(45413),w=s(8586),S=s(64412),C=s(87382),N=s(83407),I=s(58472),D=s(61476),E=s(64854),T=s(46759),R=s(18039),P=s(76400);const W=(e,t)=>{P.E8.post(`/send-email/${e}`,t).then((e=>{e.data.success?A.oR.success(e.data.message):A.oR.warn(e.data.message)})).catch((()=>{A.oR.error("Error!")}))};var _=s(80231),F=s(10810),O=s(83565),L=s(70579);(0,g.Ng)((e=>({...e.allFields})))((e=>{const t=window.location.origin+"#"+_.A.documentsPreview+"?i=",s=window.location.origin+"/#/special-preview?token=",a=e.documentData,i=a.hourly_accesses?a.hourly_accesses:[];return(0,L.jsxs)(v.A,{className:"shadow",children:[(0,L.jsxs)(k.A,{children:[(0,L.jsx)("i",{className:"fa fa-hourglass"})," Hourly dfsdf"]}),(0,L.jsx)(b.A,{children:(0,L.jsxs)(I.A,{bordered:!0,responsive:!0,children:[(0,L.jsx)("thead",{children:(0,L.jsxs)("tr",{children:[(0,L.jsx)("th",{children:"User"}),(0,L.jsx)("th",{children:"URL"})]})}),(0,L.jsx)("tbody",{children:i.map(((a,i)=>{let r=t+a.token;return a.userEmail&&(r=s+a.token),(0,L.jsxs)("tr",{children:[(0,L.jsx)("td",{children:(0,T._W)(e.users,a.userId)?(0,T._W)(e.users,a.userId):a.userEmail}),(0,L.jsxs)("td",{children:[(0,L.jsx)(D.CopyToClipboard,{text:r,onCopy:()=>A.oR.info("Copied to clipboard!"),children:(0,L.jsx)(C.A,{size:"sm",color:"info",title:"Copy to Clipboard",children:(0,L.jsx)("i",{className:"fa fa-copy text-white"})})}),(0,L.jsx)(C.A,{className:"ml-2",size:"sm",color:"primary",title:"Send Email",onClick:()=>{return e={userId:a.userId,validTill:a.validTill,url:r,userEmail:a.userEmail},void W(R.Zz,{userId:e.userId,validTill:e.validTill,url:e.url,userEmail:e.userEmail});var e},children:(0,L.jsx)("i",{className:"fa fa-arrow-up text-white"})})]})]},i)}))})]})})]})}));s(92124);(0,g.Ng)((e=>({...e.allFields})))((e=>{const t=e.documentData;console.log(t);const[s,n]=(0,a.useState)(0),[l,c]=(0,a.useState)([]),[o,d]=(0,a.useState)([{}]),[h,m]=(0,a.useState)(!1),[u,x]=(0,a.useState)(!1),[p,j]=(0,a.useState)(6e4);return(0,L.jsxs)(i.A,{children:[(0,L.jsxs)(r.A,{md:3,children:[" ",(0,L.jsxs)(y.A,{children:[(0,L.jsx)(w.A,{children:"Duration"}),(0,L.jsx)(S.A,{required:!0,type:"number",min:"0",className:"w-50",onChange:t=>{n(Number(t.target.value)),e.setDurations(Number(t.target.value))},value:s})]})]}),(0,L.jsx)(r.A,{md:3,children:(0,L.jsxs)(y.A,{children:[(0,L.jsx)(w.A,{children:"Duration Type"}),(0,L.jsxs)(S.A,{required:!0,className:"w-50",type:"select",min:"0",onChange:t=>{j(Number(t.target.value)),e.setDurationTypes(Number(t.target.value))},value:p,children:[(0,L.jsx)("option",{value:"60000",children:"Minute"}),(0,L.jsx)("option",{value:"360000",children:"Hour"}),(0,L.jsx)("option",{value:"86400000",children:"Day"})]})]})}),(0,L.jsxs)(r.A,{md:3,children:[" ",(0,L.jsxs)(y.A,{children:[(0,L.jsx)(w.A,{children:"Check Users"}),(0,L.jsx)("div",{children:(0,L.jsxs)(y.A,{check:!0,inline:!0,children:[(0,L.jsxs)(w.A,{check:!0,className:"mr-3",children:[(0,L.jsx)(S.A,{required:!0,type:"radio",name:"radio",onChange:e=>(e=>{console.log(e.target.checked),e.target.checked&&(m(!0),x(!1),d([{}]))})(e)}),"Existing Users"]}),(0,L.jsxs)(w.A,{check:!0,children:[(0,L.jsx)(S.A,{required:!0,type:"radio",name:"radio",onChange:e=>(e=>{e.target.checked&&(x(!0),m(!1),c([]))})(e)}),"Other Users"]})]})})]}),h&&(0,L.jsx)(r.A,{md:"12",children:(0,L.jsx)(E.default,{isMulti:!0,onChange:(t,s)=>{let{action:a,removedValue:i}=s;switch(a){case"remove-value":case"pop-value":if(i.isFixed)return;break;case"clear":t=e.users.filter((e=>e.isFixed))}c(t),e.setSelectedUsers(t)},value:l,name:"userAccess",className:"basic-multi-select react-select-style",classNamePrefix:"select",options:e.users?e.users.map((e=>({value:e.id,label:e.name}))):[]})}),u&&o&&o.map(((t,s)=>(0,L.jsxs)(L.Fragment,{children:[(0,L.jsxs)(r.A,{md:"12",className:"mt-3 d-flex",children:[(0,L.jsx)(S.A,{type:"email",required:!0,name:"otherUsersEmail",value:t.otherUsersEmail,onChange:t=>((t,s)=>{let a=[...o];a[s][t.target.name]=t.target.value,d(a),e.setEmails(a),console.log(a)})(t,s),placeholder:"Enter email"}),1!==o.length&&(0,L.jsx)(C.A,{size:"sm",color:"danger",title:"Delete Email",onClick:e=>((e,t)=>{const s=[...o];s.splice(t,1),d(s)})(0,s),children:(0,L.jsx)("i",{className:"fa fa-trash"})})]}),(0,L.jsx)(r.A,{children:o.length-1===s&&(0,L.jsx)(C.A,{size:"sm",color:"info",title:"Add Email",className:"text-white mt-1",onClick:e=>{d([...o,{}])},children:(0,L.jsx)("i",{className:"fa fa-plus"})})})]})))]})]})}));s(40854);const U=e=>(0,L.jsx)("div",{children:(0,L.jsxs)(y.A,{style:{marginBottom:"20px"},children:[(0,L.jsx)(w.A,{children:"Select Attachment for Redaction"}),(0,L.jsx)(E.default,{isDisabled:!!e.redactionModule,onChange:e.handleRedactionAttachmentchange,value:e.redactionValue,name:"userAccess",className:"basic-multi-select react-select-style",classNamePrefix:"select",options:e.attachments?e.attachments.filter((e=>!e.pendingApproval)).map(((e,t)=>({value:e.id,label:e.name}))):[]}),(0,L.jsx)("div",{style:{marginTop:"10px"},children:(0,L.jsx)(C.A,{style:{marginRight:"10px"},onClick:e.handleRedactionSubmit,children:"Open Redaction Tool"})})]})});s(44958);var B=s(15421);const M=e=>{const t=window.location.origin+"#"+_.A.documentsPreview+"?i=",s=window.location.origin+"/#/special-preview?token=",[n,l]=(0,a.useState)(1),[c,o]=(0,a.useState)([]),[d,h]=(0,a.useState)([{}]),[m,p]=(0,a.useState)(!1),[j,g]=(0,a.useState)(!1),[P,M]=(0,a.useState)(!1),[V,z]=(0,a.useState)(!1),[H,Y]=(0,a.useState)(!1),q=e.documentData,[$,K]=(0,a.useState)(!1),X=(e.selectedAttachmentId,q.hourly_accesses?q.hourly_accesses:[]),Z=O.parse(e.location.search).type,[G,J]=(0,a.useState)(6e4),[Q,ee]=(0,a.useState)([]),[te,se]=(0,a.useState)(!1),[ae,ie]=(0,a.useState)([]),[re,ne]=(0,a.useState)([]),[le,ce]=(0,a.useState)(!1),[oe,de]=(0,a.useState)(!1),he=a=>{if(se(!0),a.preventDefault(),de(!0),j&&null!==Q||m){K(!0),p(!1),l(1),J(6e4);const a={documentId:e.documentData.id,durationInMillis:n*G,previewUrl:t,otherUrl:s,attachmentId:Q,selectedEmails:d.map((e=>({userId:null===e||void 0===e?void 0:e.value,userEmail:null===e||void 0===e?void 0:e.userEmail}))),type:null,redact:P,redactionValue:ae,redactedAttachment:re};console.log(a.attachmentId),(0,u.sM)(a,((t,s)=>{if(!s.success)return A.oR.warning(s.message||"Empty email! Please clear email and continue!");null===a.attachmentId?A.oR.warn("Please select an attachment"):t?A.oR.error("Oops! Something went wrong"):(A.oR.success("Success!"),e.loadDocument())}))}else A.oR.warn("Please select an attachment");setTimeout((()=>{K(!1)}),500)},me=(0,L.jsx)("span",{className:"text-danger h6 ml-1",children:(0,L.jsx)("b",{children:"*"})});if($)return"Loading";return(0,L.jsxs)(L.Fragment,{children:[(0,L.jsxs)(i.A,{className:"mt-3",children:[(0,L.jsx)(r.A,{md:6,children:(0,L.jsx)(f.A,{onSubmit:he,children:(0,L.jsxs)(v.A,{className:"shadow",children:[(0,L.jsxs)(k.A,{children:[(0,L.jsx)("i",{className:"fa fa-hourglass"})," Provide Hourly Access"]}),(0,L.jsxs)(b.A,{children:[(0,L.jsx)(i.A,{children:(0,L.jsx)(r.A,{md:"12",children:(0,L.jsxs)(y.A,{children:[(0,L.jsxs)(w.A,{children:["Select Attachment ",me]}),(0,L.jsx)(E.default,{isDisabled:!!le,isMulti:!0,onChange:(t,s)=>{let{action:a,removedValue:i}=s;switch(a){case"remove-value":case"pop-value":if(i.isFixed)return;break;case"clear":t=e.attachments.filter((e=>e.isFixed))}ee(t)},value:Q,name:"userAccess",className:"basic-multi-select react-select-style",classNamePrefix:"select",options:e.attachments?e.attachments.filter((e=>!e.pendingApproval)).map(((e,t)=>({value:e.id,label:e.name}))):[]})]})})}),(0,L.jsxs)(i.A,{children:[(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)(r.A,{md:"6",children:(0,L.jsxs)(y.A,{children:[(0,L.jsxs)(w.A,{children:["Duration ",me]}),(0,L.jsx)(S.A,{type:"number",min:"0",required:!0,onChange:e=>l(Number(e.target.value)),value:n})]})}),(0,L.jsx)(r.A,{md:"6",children:(0,L.jsxs)(y.A,{children:[(0,L.jsxs)(w.A,{children:["Duration Type ",me]}),(0,L.jsxs)(S.A,{type:"select",min:"0",required:!0,onChange:e=>J(Number(e.target.value)),value:G,children:[(0,L.jsx)("option",{value:"60000",children:"Minute"}),(0,L.jsx)("option",{value:"360000",children:"Hour"}),(0,L.jsx)("option",{value:"86400000",children:"Day"})]})]})}),(0,L.jsx)(r.A,{children:(0,L.jsxs)(y.A,{children:[(0,L.jsx)(w.A,{children:"Check Users"}),(0,L.jsx)("div",{children:(0,L.jsxs)(y.A,{check:!0,inline:!0,children:[(0,L.jsxs)(w.A,{check:!0,className:"mr-3",children:[(0,L.jsx)(S.A,{required:!0,type:"radio",name:"radio",onChange:e=>(e=>{e.target.checked&&(p(!0),g(!1),h([{}]))})(e)}),"Existing Users"]}),(0,L.jsxs)(w.A,{check:!0,children:[(0,L.jsx)(S.A,{required:!0,type:"radio",name:"radio",onChange:e=>(e=>{e.target.checked&&(g(!0),p(!1),o([]))})(e)}),"Other Users"]})]})})]})})]}),(0,L.jsx)(r.A,{}),m&&(0,L.jsxs)(r.A,{md:"12",children:[me,(0,L.jsx)(E.default,{isMulti:!0,onChange:(t,s)=>{let{action:a,removedValue:i}=s;switch(a){case"remove-value":case"pop-value":if(i.isFixed)return;break;case"clear":t=e.users.filter((e=>e.isFixed))}h(t),o(t)},value:c,name:"userEmail",className:"basic-multi-select react-select-style",classNamePrefix:"select",options:e.users?e.users.map((e=>({value:e.id,label:e.name,userEmail:e.email}))):[]})]}),j&&d&&d.map(((e,t)=>(0,L.jsxs)(L.Fragment,{children:[(0,L.jsxs)(r.A,{md:"12",className:"mt-3 d-flex",children:[(0,L.jsx)(S.A,{type:"email",required:!0,name:"userEmail",value:e.otherUsersEmail,onChange:e=>((e,t)=>{let s=[...d];s[t][e.target.name]=e.target.value,h(s)})(e,t),placeholder:"Enter email"}),1!==d.length&&(0,L.jsx)(C.A,{size:"sm",color:"danger",title:"Delete Email",onClick:e=>((e,t)=>{const s=[...d];s.splice(t,1),h(s)})(0,t),children:(0,L.jsx)("i",{className:"fa fa-trash"})})]}),(0,L.jsx)(r.A,{children:d.length-1===t&&(0,L.jsx)(C.A,{size:"sm",color:"info",title:"Add Email",className:"text-white mt-1",onClick:e=>{h([...d,{}])},children:(0,L.jsx)("i",{className:"fa fa-plus"})})})]})))]})]}),(0,L.jsx)(N.A,{children:(0,L.jsx)(r.A,{className:"d-flex justify-content-end",children:(0,L.jsx)(F.A,{})})})]})})}),(0,L.jsx)(r.A,{md:6,children:(0,L.jsxs)(v.A,{className:"shadow",children:[(0,L.jsxs)(k.A,{children:[(0,L.jsx)("i",{className:"fa fa-hourglass"})," Hourly Access"]}),(0,L.jsx)(b.A,{children:(0,L.jsxs)(I.A,{bordered:!0,responsive:!0,children:[(0,L.jsx)("thead",{children:(0,L.jsxs)("tr",{children:[(0,L.jsx)("th",{children:"User"}),(0,L.jsx)("th",{children:"URL"})]})}),(0,L.jsx)("tbody",{children:X.map(((a,i)=>{let r=t+a.token+"&type="+Z+"&attachId="+a.attachmentId;return a.userEmail&&(r=s+a.token+"&type="+Z+"&hourlyAccesId="+x.A.getHash(a.id),e.documentData.id),(0,L.jsxs)("tr",{children:[(0,L.jsx)("td",{children:(0,T._W)(e.users,a.userId)?(0,T._W)(e.users,a.userId):a.userEmail}),(0,L.jsxs)("td",{children:[(0,L.jsx)(D.CopyToClipboard,{text:r,onCopy:()=>A.oR.info("Copied to clipboard!"),children:(0,L.jsx)(C.A,{size:"sm",color:"info",title:"Copy to Clipboard",children:(0,L.jsx)("i",{className:"fa fa-copy text-white"})})}),(0,L.jsx)(C.A,{className:"ml-2",size:"sm",color:"primary",title:"Send Email",onClick:()=>{return e={userId:a.userId,validTill:a.validTill,url:r,userEmail:a.userEmail},void W(R.Zz,{userId:e.userId,validTill:e.validTill,url:e.url,userEmail:e.userEmail});var e},children:(0,L.jsx)("i",{className:"fa fa-arrow-up text-white"})})]})]},i)}))})]})})]})})]}),(0,B.includeThisFeature)(B.dms_features.REDACTION)&&(0,L.jsx)("div",{className:"redaction-component",style:{marginTop:"20px",marginBottom:"20px"},children:(0,L.jsx)(U,{redactionValues:ae,handleRedactionAttachmentchange:(t,s)=>{let{action:a,removedValue:i}=s;switch(a){case"remove-value":case"pop-value":if(i.isFixed)return;break;case"clear":t=e.attachments.filter((e=>e.isFixed))}ie(t.value),ne(t),M(!0)},attachments:e.attachments,onSubmit:he,handleRedactionSubmit:e=>{window.open(`${{NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_SERVER_URL:"https://localhost:443/api",REACT_APP_SHOW_USERS:"false"}.REACT_APP_REDACTION_URL}/${ae}`,"_blank"),ce(!0),console.log(le,"this is disable select")},disableSelect:le,redactionModule:oe})})]})},V=(0,g.Ng)((e=>({...e.allFields})))((e=>(0,L.jsx)(M,{...e})));var z=s(54288),H=s(95702);const Y=(0,g.Ng)((e=>({users:e.allFields.users})))((e=>{const t=(e.documentData||{}).document_audits||[];return(0,L.jsxs)(v.A,{className:"shadow",children:[(0,L.jsx)(k.A,{children:(0,L.jsx)(i.A,{children:(0,L.jsxs)(r.A,{children:[(0,L.jsx)("i",{className:"fas  fa-file-alt"})," Document Access Logs"]})})}),(0,L.jsxs)(b.A,{children:[(0,L.jsxs)(I.A,{responsive:!0,bordered:!0,hover:!0,id:"toExcel",children:[(0,L.jsx)("thead",{children:(0,L.jsxs)("tr",{children:[(0,L.jsx)("th",{children:"Access Type"}),(0,L.jsx)("th",{children:"Type"}),(0,L.jsx)("th",{children:"Date"}),(0,L.jsx)("th",{children:"Time"}),(0,L.jsx)("th",{children:"Accessed By"})]})}),(0,L.jsx)("tbody",{children:t.map((t=>(0,L.jsxs)("tr",{children:[(0,L.jsx)("td",{children:t.accessType.toUpperCase()}),(0,L.jsx)("td",{children:t.on}),(0,L.jsx)("td",{children:new Date(t.dateTime).toDateString()}),(0,L.jsx)("td",{children:new Date(t.dateTime).toTimeString()}),(0,L.jsx)("td",{children:1===(null===t||void 0===t?void 0:t.accessedBy)?(0,L.jsx)("p",{children:"Admin"}):(0,T._W)(e.users,t.accessedBy)})]},t.id)))})]}),(0,L.jsx)(H.A,{id:"toExcel-button",className:"btn btn-sm btn-primary text-white float-right",table:"toExcel",filename:"accesslogs",sheet:"tablexls",buttonText:"Download Report"})]})]})}));var q=s(56059),$=s(22978),K=s(86178),X=s.n(K);(0,g.Ng)((e=>({users:e.allFields.users})))((e=>{const t=e.checkoutInfos?e.checkoutInfos.reverse():[],s=t[0]||{},a=e.documentId;return(0,L.jsxs)(v.A,{className:"my-3 shadow",children:[(0,L.jsx)(k.A,{className:"bg-warning",children:"Checkout information"}),(0,L.jsx)(b.A,{children:(0,L.jsxs)(I.A,{bordered:!0,responsive:!0,children:[(0,L.jsx)("thead",{children:(0,L.jsxs)("tr",{children:[(0,L.jsx)("th",{children:"Name"}),(0,L.jsx)("th",{children:"Checkout Date"}),(0,L.jsx)("th",{children:"CheckIn Date"}),(0,L.jsx)("th",{children:"Description"}),(0,L.jsx)("th",{children:"Status"})]})}),(0,L.jsx)("tbody",{children:t.map(((t,s)=>(0,L.jsxs)("tr",{children:[(0,L.jsx)("td",{children:(0,T._W)(e.users,t.userId)}),(0,L.jsx)("td",{children:X()(t.createdAt).format("YYYY-MM-DD")}),(0,L.jsx)("td",{children:t.isReturned?X()(t.updatedAt).format("YYYY-MM-DD"):"Not Returned"}),(0,L.jsx)("td",{children:t.description}),(0,L.jsx)("td",{children:t.isReturned?(0,L.jsx)("span",{className:"badge badge-pill badge-success p-1 pl-2 pr-2",children:"Returned"}):(0,L.jsx)("span",{className:"badge badge-pill badge-danger p-1 pl-2 pr-2",children:"Not Returned"})})]},s)))})]})}),(0,L.jsx)(N.A,{children:!1===s.isReturned?(0,L.jsx)(C.A,{className:"float-right",onClick:()=>{(0,u.kP)({isReturned:!0,documentId:a,statusId:1},((t,s)=>{console.log(s),t?A.oR.error("Error!"):s.success?(A.oR.success(s.message),e.loadDocument()):A.oR.warn("Oops! Something went wrong")}))},size:"sm",color:"success",children:"Check in"}):null})]})}));var Z=s(71020);const G="/document/doc-archive";const J=(0,g.Ng)((e=>e.allFields))((e=>{const[t,s]=(0,a.useState)(!1),[i,r]=(0,a.useState)(e.documentData.isArchived||!1);(0,a.useEffect)((()=>{e.documentData&&(0,Z.wO)(e.documentData.id,((t,a)=>{t?console.log("Fav Fetch Error"):(r(!!e.documentData.isArchived),s("true"===a.data))}))}),[e.documentData]);return(0,L.jsx)(L.Fragment,{children:(0,L.jsx)(v.A,{className:"shadow",children:(0,L.jsxs)(b.A,{children:[(0,L.jsx)(f.A,{className:"ml-4",children:(0,L.jsxs)(w.A,{check:!0,children:[(0,L.jsx)(S.A,{type:"checkbox",value:t,onChange:t=>(t=>{s(t.target.checked);const a={documentId:e.documentData.id,isfavourite:t.target.checked};(0,Z.HI)(a,((e,t)=>{if(e)return A.oR.error("Error!")}))})(t),checked:!!t,className:"mt-0"}),"Add to Favourite List",t?(0,L.jsx)("i",{className:"fas  fa-star ml-1 text-warning"}):(0,L.jsx)("i",{className:"fas  fa-star ml-1"})]})}),e.permissions.archived?(0,L.jsx)(f.A,{className:"ml-4",children:(0,L.jsxs)(w.A,{check:!0,children:[(0,L.jsx)(S.A,{type:"checkbox",checked:i,disabled:i,onChange:t=>{if(!window.confirm("Do you want to Archive this document?"))return;const s={documentId:e.documentData.id,isArchived:t.target.checked};var a,i;a=s,i=(e,t)=>{e?A.oR.error("Error!"):null!==t&&void 0!==t&&t.success?(r(!0),A.oR.success(t.message)):A.oR.error(null===t||void 0===t?void 0:t.message)},P.E8.post(G,a).then((e=>e.data)).then((e=>i(null,e))).catch((e=>{console.log(e)}))},className:"mt-0"}),"Archived Now",i?(0,L.jsx)("i",{className:"fas  fa-archive ml-1 text-primary"}):(0,L.jsx)("i",{className:"fas  fa-archive ml-1"})]})}):null]})})})}));var Q=s(55103),ee=s(18103),te=s(14524),se=s(83886),ae=s(32936),ie=s(30360),re=s(64545),ne=s(54798);const le=e=>{console.log(e.saveSettings),console.log(e.defaultWatermarkSettings);const[t,s]=(0,a.useState)(!1);return(0,L.jsx)("div",{children:(0,L.jsx)("div",{className:"watermark-settings-section",children:(0,L.jsxs)("span",{className:"watermarkSettings mb-2",children:[(0,L.jsx)(C.A,{style:{backgroundColor:"transparent",marginBottom:"1px"},onClick:e.toggle,children:(0,L.jsx)(te.A,{})}),(0,L.jsxs)(ae.A,{isOpen:e.modal,toggle:e.toggle,size:"lg","aria-labelledby":"contained-modal-title-vcenter",centered:!0,children:[(0,L.jsx)(ie.A,{style:{padding:"15px 35px",backgroundColor:"#f1f1f1",fontSize:"20px",display:"block"},toggle:e.toggle,children:"Please select your watermark configuration"}),(0,L.jsx)(re.A,{style:{backgroundColor:"#f1f1f1"},children:(0,L.jsx)("div",{className:"modal-form",children:(0,L.jsx)("div",{className:"modal-form-content",children:(0,L.jsxs)("form",{onSubmit:e.formSubmit,className:"watermark-form",children:[(0,L.jsx)("label",{for:"watermarkText",className:"watermark-form-label",style:{fontSize:"14px"},children:"Watermark Text:"}),(0,L.jsx)("input",{type:"text",id:"watermarkText",name:"watermarkText",className:"watermark-form-input"}),(0,L.jsx)("br",{}),(0,L.jsx)("label",{for:"watermarkPosition",className:"watermark-form-label",style:{fontSize:"14px"},children:"Watermark Position:"}),(0,L.jsxs)("select",{name:"watermarkPosition",id:"watermarkPosition",className:"watermark-form-label",children:[(0,L.jsx)("option",{value:"",disabled:!0,selected:!0,children:"Select your option"}),(0,L.jsx)("option",{value:"1",children:"Center(default)"}),(0,L.jsx)("option",{value:"2",children:"Top Right"}),(0,L.jsx)("option",{value:"3",children:"Top Left"}),(0,L.jsx)("option",{value:"4",children:"Bottom Right"}),(0,L.jsx)("option",{value:"5",children:"Bottom Left"}),(0,L.jsx)("option",{value:"6",children:"Diagonal"})]}),(0,L.jsx)("label",{for:"watermarkImage",className:"watermark-form-label",style:{fontSize:"14px"},children:"Watermark Image:"}),(0,L.jsx)("br",{}),(0,L.jsx)("input",{type:"file",id:"watermarkImage",name:"watermarkImage",className:"watermark-form-image-input"}),(0,L.jsx)("br",{}),(0,L.jsx)(se.A,{disabled:e.defaultWatermarkSettings,onChange:e.onCheckboxChange,checked:e.saveSettings,children:"Save this configuration for all documents."}),(0,L.jsx)("br",{}),(0,L.jsx)(se.A,{disabled:e.saveSettings,onChange:e.onDefaultCheckboxChange,checked:e.defaultWatermarkSettings,children:"Use default configuration."}),(0,L.jsx)("br",{}),(0,L.jsx)("br",{}),(0,L.jsx)("button",{style:{textAlign:"center",display:"block",margin:"0 auto",width:"250px"},type:"submit",className:"watermark-form-submit-button",children:"Submit"})]})})})}),(0,L.jsx)(ne.A,{style:{backgroundColor:"#f1f1f1"},children:(0,L.jsx)(C.A,{color:"secondary",onClick:e.toggle,children:"Cancel"})})]})]})})})};var ce=s(96072);function oe(e,t,s,a,i){return{key:t,icon:s,children:a,label:e,type:i}}const de=[oe("","sub1",(0,L.jsx)(te.A,{}),[oe("Select Watermark Position",null,null,[oe("Center(default)","1"),oe("Top Right","2"),oe("Top Left","3"),oe("Bottom Right","4"),oe("Bottom Left","5"),oe("Diagonal","6")],"group")])],he=e=>(0,L.jsx)("div",{children:(0,L.jsx)("div",{className:"watermark-settings-section",children:(0,L.jsx)("span",{className:"watermarkSettings",children:(0,L.jsx)(ce.A,{onClick:t=>e.handleCustomWatermark(t),style:{backgroundColor:"transparent",width:50,margin:"0px 0px 0px 0px"},mode:"vertical",items:de})})})});function me(){document.getElementById("loading").style.display="none"}class ue extends a.Component{constructor(){super(...arguments),this.state={activeTab:1==this.props.userProfile.roleId?"1":"2",isSuperAdmin:1==this.props.userProfile.roleId,documentData:{},documentAudits:[],attachments:[],showInAttachment:[],imageAttachments:[],documentTypes:[],owners:[],statuses:[],languages:[],documentConditions:[],makerOrChecker:{},options_maker:[],departments:[],locationMaps:[],securityLevel:[],isImage:!0,json:null,attachmentId:null,associatedBokIds:[],otpVerified:!1,allTags:[],watermarkPosition:1,customWatermarkId:null,saveSettings:!1,modal:!1,defaultWatermarkSettings:!1},this.handleVerifyOtp=e=>{this.setState({otpVerified:e})},this.loadDocument=()=>{document.getElementById("loading").style.display="unset";let e="",t="";try{const s=O.parse(this.props.location.search);e=x.A.getId(s["?i"]),t=s.type?s.type:null,x.A.getId(this.props.match.params.id),this.setState.types(t)}catch(s){}Number(e)?(0,u.YE)(t,e,((e,s)=>{if(t&&this.setState({activeTab:"3"}),e)A.oR.error("Could not access this document at the moment!"),this.props.history.push(_.A.documentsList);else if(s.success){const{data:e,showInAttachment:t}=s.attachments;this.setState({documentData:s.data,json:s,attachments:e||[],makerOrChecker:s.makerOrChecker||{},options_maker:s.options_maker||[],associatedBokIds:s.associatedIds,showInAttachment:t,allTags:s.docTags})}else A.oR.error(s.message),this.props.history.push(_.A.documentsList);me()})):(A.oR.error("Invalid ID!"),this.props.history.push(_.A.documentsList),me())},this.setSelectedAttachmentId=e=>{this.setState({attachmentId:e})},this.handleModalOpen=()=>{this.setState({opened:!0})},this.handleChange=e=>{const t=e.target.name,s=e.target.value;if("documentTypeId"===t&&this.setState({documentTypeId:s}),"securityLevel"===t){const e=j().find(this.state.securityLevels,(e=>e.id===Number(s)));e?this.setState({securityLevelCheck:e.value}):this.setState({securityLevelCheck:0})}},this.formSubmit=e=>{var t;e.preventDefault();null===(t=this.state.attachments)||void 0===t||t.map((e=>e.id));let s=new FormData;var a,i;s.append("watermarkText",e.target.watermarkText.value),s.append("watermarkPosition",e.target.watermarkPosition.value||1),s.append("watermarkImage",e.target.watermarkImage.files[0]||""),s.append("isActive",this.state.defaultWatermarkSettings),s.append("userId",this.props.userProfile.id),s.append("saveSettings",this.state.saveSettings),a=s,i=(e,t)=>{if(e)A.oR.error(e.response.data.message);else{const e=t.data;this.setState({customWatermarkId:e})}},P.E8.post("http://localhost:8181/api/custom-watermark",a).then((e=>{i(null,e.data)})).catch((e=>{i(e)})),this.toggle()},this.handleCustomWatermark=e=>{this.setState({watermarkPosition:e.key})},this.onCheckboxChange=e=>{console.log(`checked = ${e.target.checked}`),this.setState({saveSettings:!this.state.saveSettings})},this.onDefaultCheckboxChange=e=>{this.setState({defaultWatermarkSettings:!this.state.defaultWatermarkSettings})},this.toggle=()=>this.setState({modal:!this.state.modal}),this.defaultWatermark=()=>{this.setState({defaultWatermarkSettings:!0})}}componentDidUpdate(e){console.log(this.props.location.search,e.location.search),this.props.location.search!==e.location.search&&this.loadDocument()}componentDidMount(){this.loadDocument(),this.setState(this.props.allFields)}render(){const e=this.props.permissions.maker,t=(this.props.permissions.checker,this.props.permissions||{}),s=(t.document===ee.Xd||t.document===ee.n7)&&this.state.documentData.isApproved;return this.state.documentData.hasOtp&&!this.state.otpVerified?(0,L.jsx)(Q.A,{handleVerifyOtp:this.handleVerifyOtp}):(0,L.jsxs)(i.A,{children:[(0,L.jsxs)(r.A,{md:4,children:[(0,L.jsx)(z.A,{isPrimary:!0,json:this.state.json,makerOrChecker:this.state.makerOrChecker,documentData:this.state.documentData,loadDocument:this.loadDocument,permissions:t,tags:this.state.allTags}),(0,L.jsx)(J,{isPrimary:!0,documentData:this.state.documentData,permissions:t})]}),(0,L.jsxs)(r.A,{md:8,className:"watermark-columns",children:[e&&(0,B.includeThisFeature)(B.dms_features.BASIC_WATERMARK)?(0,L.jsx)(he,{handleCustomWatermark:e=>this.handleCustomWatermark(e),watermarkPosition:this.state.watermarkPosition,customWatermarkId:this.state.customWatermarkId}):(0,L.jsx)(le,{saveSettings:this.state.saveSettings,defaultWatermarkSettings:this.state.defaultWatermarkSettings,onDefaultCheckboxChange:this.onDefaultCheckboxChange,defaultWatermark:this.defaultWatermark,toggle:this.toggle,modal:this.state.modal,onCheckboxChange:this.onCheckboxChange,handleCustomWatermark:e=>this.handleCustomWatermark(e),watermarkPosition:this.state.watermarkPosition,formSubmit:this.formSubmit}),(0,L.jsx)(q.A,{isActive:this.state.saveSettings,customWatermarkId:this.state.customWatermarkId,setSelectedAttachmentId:this.setSelectedAttachmentId,attachments:this.state.attachments,permissions:t,isDeleted:this.state.isDeleted,type:this.state.type,watermarkPosition:this.state.watermarkPosition})]}),(0,L.jsx)(r.A,{md:12,children:(0,L.jsx)($.A,{isPrimary:!0,isActive:this.state.saveSettings,customWatermarkId:this.state.customWatermarkId,isOpened:this.state.opened,watermarkPosition:this.state.watermarkPosition,documentData:this.state.documentData,makerOrChecker:this.state.makerOrChecker,options_maker:this.state.options_maker,attachments:this.state.attachments,showInAttachment:this.state.showInAttachment,associatedBokIds:this.state.associatedBokIds,documentTypes:this.state.documentTypes,permissions:t,documentId:this.state.documentData.id,loadDocument:this.loadDocument,handleModalOpen:this.handleModalOpen,afterDelete:()=>this.setState({isDeleted:!0})})}),(0,L.jsxs)(r.A,{className:"my-3",md:12,children:[(0,L.jsxs)(n.A,{tabs:!0,children:[this.state.isSuperAdmin&&(0,L.jsx)(l.A,{children:(0,L.jsx)(c.A,{className:m()({active:"1"===this.state.activeTab}),onClick:()=>this.setState({activeTab:"1"}),children:"Audit Logs"})}),(0,L.jsx)(l.A,{}),s&&(0,L.jsx)(l.A,{children:(0,L.jsx)(c.A,{className:m()({active:"3"===this.state.activeTab}),onClick:()=>this.setState({activeTab:"3"}),children:"Hourly Access"})})]}),(0,L.jsxs)(o.A,{activeTab:this.state.activeTab,children:[this.state.isSuperAdmin&&(0,L.jsx)(d.A,{tabId:"1",children:(0,L.jsx)(Y,{documentData:this.state.documentData})}),s&&(0,L.jsx)(d.A,{tabId:"3",children:(0,L.jsx)(V,{...this.props,selectedAttachmentId:this.state.attachmentId,type:this.state.types,documentData:this.state.documentData,loadDocument:this.loadDocument,attachments:this.state.attachments})})]})]})]})}}const xe=(0,g.Ng)((e=>({allFields:e.allFields,userProfile:e.userProfile})))(ue)},71020:(e,t,s)=>{s.d(t,{HI:()=>r,wO:()=>n});var a=s(76400);const i="/favourite";function r(e,t){a.E8.post(i,e).then((e=>e.data)).then((e=>{t(null,e)})).catch((e=>{console.log(e)}))}function n(e,t){a.E8.get(`${i}`,{params:{docId:e}}).then((e=>e.data)).then((e=>{t(null,e)})).catch((e=>{console.log(e),t(e)}))}},92124:(e,t,s)=>{s.r(t),s.d(t,{default:()=>y});var a=s(65043),i=s(40832),r=s.n(i),n=s(76400),l=s(58441),c=s(40575),o=s(75304),d=s(38477),h=s(25852),m=s(13718),u=s(45413),x=s(8586),p=s(64412),j=s(44864),g=s(83407),A=s(97956),f=s(80231),v=s(28096),k=s(3770),b=s(70579);const y=e=>{let t=document.getElementById("file-viewer");const[s,i]=(0,a.useState)([{}]),[y,w]=(0,a.useState)([{}]),[S,C]=(0,a.useState)(!0),[N,I]=(0,a.useState)("");let D=e.location.state.selectedAttachmentId;return r()({path:"./lib",initialDoc:"",fullAPI:!0,enableRedaction:!0,documentType:"pdf"},t).then((t=>{!function(e){e.enableElements(["bookmarksPanel","bookmarksPanelButton"]),e.enableFeatures([e.Feature.Measurement])}(t);l.A.getId(e.location.hash.slice(1));document.getElementById("select").onchange=e=>{let s=e.target.options[e.target.selectedIndex].attributes.fileId.value;(0,c.gy)(s,((e,s)=>{if(!e)if(s.success){const e=n.UB+"/"+s.filePath;t.loadDocument(e)}else window.alert(s.message)}))};const{docViewer:s,annotManager:a,CoreControls:i,Annotations:r}=t;s.on("documentLoaded",(()=>{const e=new r.RedactionAnnotation;a.addAnnotation(e),a.drawAnnotationsFromList(e)})),t.setHeaderItems((t=>{t.push({type:"actionButton",img:"icon-chevron-right",onClick:async()=>{const t={xfdfString:await a.exportAnnotations(),flags:i.SaveOptions.LINEARIZED,downloadType:"pdf"},r=s.getDocument(),l=r.filename,c=await r.getFileData(t),o=new Blob([c],{type:"application/pdf"}),d=new FormData;for(var h of(d.append("fileType",t.downloadType),d.append("itemId",N.itemId),d.append("itemType","document"),d.append("redaction",S),d.append("file",o,l),d))console.log(h);n.E8.post("/attachment",d).then((t=>{e.history.push(f.A.documentsView+"?i="+e.location.hash.slice(1)+"&type=redact"),v.oR.success("successfully redacted")})).catch((e=>console.log(e)))}})}))})).catch((e=>console.log(e))),(0,a.useEffect)((()=>{(0,k.fv)(D,((e,t)=>{e&&console.log(e),I(t)})),(()=>{let t=l.A.getId(e.location.hash.slice(1));t&&(0,c.YE)("",t,((e,t)=>{t.success&&(i(t.data),w(t.data.attachments?t.data.attachments:[]))}))})()}),[]),(0,b.jsx)(b.Fragment,{children:(0,b.jsxs)(o.A,{className:"shadow",children:[(0,b.jsxs)(d.A,{children:[" ",(0,b.jsx)(h.A,{children:(0,b.jsx)(m.A,{children:(0,b.jsxs)(u.A,{children:[(0,b.jsx)(x.A,{children:"Select Files"}),(0,b.jsxs)(p.A,{id:"select",type:"select",className:"w-50",children:[(0,b.jsx)("option",{children:"--NONE--"}),(0,b.jsx)("option",{value:N.filePath,name:N.name,fileId:Number(N.id),children:N.name})]})]})})})]}),(0,b.jsx)(j.A,{children:(0,b.jsx)("div",{className:"webviewer",id:"file-viewer",style:{height:"100vh"}})}),(0,b.jsx)(g.A,{className:"d-flex justify-content-end",children:(0,b.jsx)(A.A,{onClick:()=>window.history.back()})})]})})}},18103:(e,t,s)=>{s.d(t,{H6:()=>r,Sz:()=>i,Xd:()=>a.Xd,n7:()=>a.n7});var a=s(18039);const i=[{value:a.x3,label:"--- NONE ---"},{value:a.gR,label:"View"},{value:a.Xd,label:"Edit"},{value:a.n7,label:"Edit / Delete"}],r=[{value:!1,label:"No"},{value:!0,label:"Yes"}]}}]);
//# sourceMappingURL=107.a8e042bf.chunk.js.map