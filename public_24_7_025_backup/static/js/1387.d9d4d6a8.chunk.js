"use strict";(self.webpackChunkgeneral_dms=self.webpackChunkgeneral_dms||[]).push([[1387],{86710:(e,t,s)=>{s.d(t,{A:()=>r});s(65043);var n=s(64854),a=s(45413),l=s(8586),i=s(70579);function r(e){var t,s;let{label:r,onChange:d,required:h,errors:c,object:o,options:u,isEdit:m,name:p,getFieldValue:x,...v}=e;return u=null===(t=u)||void 0===t?void 0:t.map((e=>({...e,label:null===e||void 0===e?void 0:e.name,value:(null===e||void 0===e?void 0:e[x])||(null===e||void 0===e?void 0:e.id)}))),u=null===(s=u)||void 0===s?void 0:s.map((e=>{let t="",s=null!==e&&void 0!==e&&e.level?null===e||void 0===e?void 0:e.level:0;for(;s-- >0;)t+="---";return{...e,label:t+" "+e.label}})),(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)(a.A,{children:[(0,i.jsxs)(l.A,{children:[r||"",h&&(0,i.jsx)("span",{className:"text-danger h6 ml-1",children:(0,i.jsx)("b",{children:"*"})})]}),(0,i.jsx)(n.default,{...m?{value:o[p]?o[p]:""}:{},name:p,options:u,onChange:d,...v}),c?(0,i.jsx)("span",{className:"text text-danger",children:c[0]}):null]})})}},51387:(e,t,s)=>{s.r(t),s.d(t,{default:()=>I});var n=s(65043),a=s(25852),l=s(13718),i=s(94576),r=s(75304),d=s(38477),h=s(44864),c=s(45413),o=s(8586),u=s(64412),m=s(83407),p=s(64854),x=(s(86453),s(3531)),v=s(97508),j=s(80231),A=s(28096),b=s(10810),f=s(97956),N=s(19368),g=(s(86710),s(70579));class y extends n.Component{constructor(){super(...arguments),this.state={users:[],user:{},selectedBranch:null,branches:[],selectedOption:{},selectedOptions:[],isDisabled:!1},this.handleChange=e=>{let{user:t}=this.state;const{name:s,value:n,type:a}=e.target;if("hierarchy"===s){let e=null,s=null;if(n.startsWith("Dept_")){const s=n.match(/\d+$/);s&&(e=s[0]),this.setState({departmentId:e,branchId:null}),t.departmentId=e,t.branchId=null}else if(n.startsWith("Branch_")){const e=n.match(/\d+$/);e&&(s=e[0]),this.setState({branchId:s,departmentId:null}),t.branchId=s,t.departmentId=null}this.setState({security_hierarchy:n})}switch("roleId"===s&&(t.roleId=n),a){case"checkbox":t[s]=e.checked;break;case"textarea":t.notes=n;break;default:t[s]=n}this.setState({user:t})},this.handleUserChange=e=>{const t=e.value;if(t){var s;this.setState({selectedOption:e});const n=null===(s=this.state.users)||void 0===s?void 0:s.filter((e=>e.sAMAccountName===t?1:0))[0];this.setState({user:n||{}})}else{const e=Object.keys(this.state.user),t={};e.forEach((e=>t[e]="")),this.setState({user:t})}},this.handleSubmit=e=>{e.preventDefault();const t={...this.state.user};if(!t.roleId)return A.oR.warn("Role must be selected");if(!t.hierarchy)return A.oR.warn("Hierarchy must be selected");if(!this.state.user.sAMAccountName)return A.oR.warn("User must be selected");if(t.hierarchy.startsWith("Dept_")){const e=t.hierarchy.match(/\d+$/);e&&(t.departmentId=e[0]),t.branchId=null}if(t.hierarchy.startsWith("Branch_")){const e=t.hierarchy.match(/\d+$/);e&&(t.branchId=e[0]),t.departmentId=null}(0,x.nu)(t,((e,t)=>{var s;if(e)return 403===(null===e||void 0===e||null===(s=e.response)||void 0===s?void 0:s.status)?(A.oR.error("Unable to add user maximum number exceeded"),void this.setState({isDisabled:!1})):void A.oR.error("There are some errors with the data provided.");t&&(this.props.history.push(j.A.adminLdapUsers),this.setState({isDisabled:!0}))}))}}componentDidMount(){var e;this._isMounted=!0;const t=null===(e=this.props.branches)||void 0===e?void 0:e.map((e=>({value:e.id,label:e.name})));this.setState({branches:t}),(0,x.en)(((e,t)=>{var s;if(e)return;const n=null===(s=t.data)||void 0===s?void 0:s.map((e=>({value:e.sAMAccountName,label:e.displayName})));this.setState({users:t.data,selectedOptions:n})}))}render(){var e;const{selectedOptions:t}=this.state;return(0,g.jsx)("div",{className:"animated fadeIn",children:(0,g.jsx)(a.A,{children:(0,g.jsx)(l.A,{xl:12,children:(0,g.jsx)(i.A,{onSubmit:this.handleSubmit,children:(0,g.jsxs)(r.A,{className:"shadow",children:[(0,g.jsx)(d.A,{children:(0,g.jsx)("p",{className:"h5",children:"AD Users"})}),(0,g.jsxs)(h.A,{children:[(0,g.jsxs)(c.A,{children:[(0,g.jsx)(o.A,{htmlFor:"user",children:"User"}),(0,g.jsx)(p.default,{value:this.state.selectedOption,onChange:this.handleUserChange,options:t||[]})]}),(0,g.jsxs)(a.A,{children:[(0,g.jsx)(l.A,{xs:"6",children:(0,g.jsxs)(c.A,{children:[(0,g.jsx)(o.A,{htmlFor:"email",children:"Email"}),(0,g.jsx)(u.A,{type:"text",id:"email",placeholder:"Email",value:this.state.user.mail?this.state.user.mail:"",readOnly:!0})]})}),(0,g.jsx)(l.A,{xs:"6",children:(0,g.jsxs)(c.A,{children:[(0,g.jsx)(o.A,{htmlFor:"telephoneNumber",children:"Phone Number"}),(0,g.jsx)(u.A,{className:"rounded",type:"text",id:"telephoneNumber",placeholder:"Phone Number",value:this.state.user.telephoneNumber?this.state.user.telephoneNumber:"",readOnly:!0})]})}),(0,g.jsx)(l.A,{xs:"4",children:(0,g.jsxs)(c.A,{children:[(0,g.jsx)(o.A,{htmlFor:"username",children:"Username"}),(0,g.jsx)(u.A,{className:"rounded",type:"text",id:"username",placeholder:"User Name",value:this.state.user.sAMAccountName?this.state.user.sAMAccountName:"",readOnly:!0})]})}),(0,g.jsx)(l.A,{xs:"4",children:(0,g.jsxs)(c.A,{children:[(0,g.jsx)(o.A,{htmlFor:"Name",children:"Name"}),(0,g.jsx)(u.A,{className:"rounded",type:"text",id:"name",placeholder:"Name",value:(this.state.user.givenName?this.state.user.givenName:"")+" "+(this.state.user.sn?this.state.user.sn:""),readOnly:!0})]})}),(0,g.jsx)(l.A,{xs:"4",children:(0,g.jsxs)(c.A,{children:[(0,g.jsx)(o.A,{htmlFor:"roleId",children:"Role"}),(0,g.jsxs)(u.A,{className:"rounded",type:"select",id:"roleId",name:"roleId",required:!0,onChange:this.handleChange,children:[(0,g.jsx)("option",{value:"",children:"Select User Role"}),null===(e=this.props.roles)||void 0===e?void 0:e.map(((e,t)=>(0,g.jsx)("option",{value:e.id,children:e.name},t)))]})]})}),(0,g.jsx)(l.A,{xs:"4",children:(0,g.jsx)(N.Ae,{required:!0,label:"Security Hierarchy",name:"hierarchy",options:this.props.allFields.hierarchy,onChange:this.handleChange,object:this.state.user,value:this.state.hierarchy,isEdit:!0})}),(0,g.jsx)(l.A,{xs:"4",children:(0,g.jsxs)(c.A,{children:[(0,g.jsx)(o.A,{htmlFor:"loginAttempts",children:"Login Attempts"}),(0,g.jsxs)(u.A,{className:"rounded",type:"select",id:"loginAttempts",name:"loginAttempts",required:!0,children:[(0,g.jsx)("option",{value:10,children:"10"}),(0,g.jsx)("option",{value:5,children:"5"}),(0,g.jsx)("option",{value:3,children:"3"})]})]})})]})]}),(0,g.jsx)(m.A,{children:(0,g.jsxs)("div",{className:"float-right",children:[(0,g.jsx)(f.A,{onClick:()=>window.history.back()}),(0,g.jsx)(b.A,{isDisabled:this.state.isDisabled})]})})]})})})})})}}const I=(0,v.Ng)((e=>({allFields:e.allFields,roles:e.allFields.roles,branches:e.allFields.branches,departments:e.allFields.departments})))(y)},3531:(e,t,s)=>{s.d(t,{en:()=>i,gw:()=>h,hG:()=>c,lo:()=>l,nu:()=>d,wz:()=>r});var n=s(76400);const a="/ad-users";function l(e){n.E8.get(`${a}`).then((function(t){e(null,t.data)})).catch((function(t){e(t)}))}function i(e){n.E8.get(`${a}/ldap`).then((function(t){e(null,t.data)})).catch((function(t){e(t)}))}function r(e,t){n.E8.get(`${a}/${e}`).then((function(e){t(null,e.data)})).catch((function(e){t(e)}))}function d(e,t){n.E8.post(`${a}`,JSON.stringify(e)).then((function(e){t(null,e.data)})).catch((function(e){t(e)}))}function h(e,t){n.E8.put(`${a}/${e.id}`,JSON.stringify(e)).then((function(e){t(null,e.data)})).catch((function(e){t(e)}))}function c(e,t){n.E8.delete(`${a}/${e}`).then((function(e){t(null,e.data)})).catch((function(e){t(e)}))}}}]);
//# sourceMappingURL=1387.d9d4d6a8.chunk.js.map