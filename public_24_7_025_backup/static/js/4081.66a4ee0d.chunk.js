"use strict";(self.webpackChunkgeneral_dms=self.webpackChunkgeneral_dms||[]).push([[4081],{64081:(e,a,t)=>{t.r(a),t.d(a,{default:()=>T});var r=t(65043),s=t(75304),n=t(38477),l=t(45413),o=t(8586),c=t(64412),i=t(44864),d=t(25852),h=t(13718),m=t(83407),u=t(87382),f=t(56253),p=t(48201);const b=["Header","Label","Paragraph","LineBreak","Dropdown","Tags","Checkboxes","RadioButtons","TextInput","NumberInput","TextArea","DatePicker","HyperLink","Table"],x=[{key:"Header",name:"Header Text",icon:"fa fa-header",static:!0,content:"Placeholder Text..."},{key:"Label",name:"Label",static:!0,icon:"fa fa-font",content:"Placeholder Text..."},{key:"Paragraph",name:"Paragraph",static:!0,icon:"fa fa-paragraph",content:"Placeholder Text..."},{key:"LineBreak",name:"Line Break",static:!0,icon:"fa fa-arrows-h"},{key:"Dropdown",canHaveAnswer:!0,name:"Dropdown",icon:"fa fa-caret-square-o-down",label:"Placeholder Label",field_name:"dropdown_",options:[]},{key:"Tags",canHaveAnswer:!0,name:"Tags",icon:"fa fa-tags",label:"Placeholder Label",field_name:"tags_",options:[]},{key:"Checkboxes",canHaveAnswer:!0,name:"Checkboxes",icon:"fa fa-check-square-o",label:"Placeholder Label",field_name:"checkboxes_",options:[]},{key:"RadioButtons",canHaveAnswer:!0,name:"Multiple Choice",icon:"fa fa-dot-circle-o",label:"Placeholder Label",field_name:"radiobuttons_",options:[]},{key:"TextInput",canHaveAnswer:!0,name:"Text Input",label:"Placeholder Label",icon:"fa fa-font",field_name:"text_input_"},{key:"NumberInput",canHaveAnswer:!0,name:"Number Input",label:"Placeholder Label",icon:"fa fa-plus",field_name:"number_input_"},{key:"TextArea",canHaveAnswer:!0,name:"Multi-line Input",label:"Placeholder Label",icon:"fa fa-text-height",field_name:"text_area_"},{key:"Image",name:"Image",label:"",icon:"fa fa-photo",field_name:"image_",src:""},{key:"Rating",canHaveAnswer:!0,name:"Rating",label:"Placeholder Label",icon:"fa fa-star",field_name:"rating_"},{key:"DatePicker",canDefaultToday:!0,canReadOnly:!0,dateFormat:"MM/dd/yyyy",timeFormat:"hh:mm aa",showTimeSelect:!1,showTimeSelectOnly:!1,name:"Date",icon:"fa fa-calendar",label:"Placeholder Label",field_name:"date_picker_"},{key:"Signature",canReadOnly:!0,name:"Signature",icon:"fa fa-pencil-square-o",label:"Signature",field_name:"signature_"},{key:"HyperLink",name:"Web site",icon:"fa fa-link",static:!0,content:"Placeholder Web site link ...",href:"http://www.example.com"},{key:"Download",name:"File Attachment",icon:"fa fa-file",static:!0,content:"Placeholder file name ...",field_name:"download_",file_path:"",_href:""},{key:"Range",name:"Range",icon:"fa fa-sliders",label:"Placeholder Label",field_name:"range_",step:1,default_value:3,min_value:1,max_value:5,min_label:"Easy",max_label:"Difficult"},{key:"Camera",name:"Camera",icon:"fa fa-camera",label:"Placeholder Label",field_name:"camera_"},{key:"Table",name:"Table",icon:"fa fa-table",field_name:"table_",label:"Placceholder Label",options:[],rows:[]}].filter((e=>b.includes(e.key)?1:0));var k=t(58441),w=t(28096),v=t(83565),y=t(58472),g=t(68499),j=t(67735),A=t(53536),_=t.n(A),N=t(70579);const C=e=>{const[a,t]=(0,r.useState)({}),[f,p]=(0,r.useState)({}),b=e.users,x=a=>{if(e.setHasUser){const t=a.workflow_users||[],r=_().last(t);r&&e.setHasUser("approver"===r.type)}};(0,r.useEffect)((()=>{e.workflowId&&(0,g.Mw)(e.workflowId,((e,a)=>{e?w.oR.error("Error!"):t(a),x(a)}))}),[e.workflowId]);const k=(e,r)=>{let s=a.workflow_users||[];const n=_().findLast(s),l={workflowId:a.id,userId:r.userId,type:r.type,level:n?n.level+1:1};switch(e){case"add":const e=_().find(s,{type:"approver"});switch(l.type){case"approver":e?w.oR.warn("Cannot add two approvers"):s.push(l);break;case"recommender":e?w.oR.warn("Cannot add recommender after approver"):s.push(l)}break;case"delete":s=s.filter(((e,a)=>a===r.index?0:1)).map(((e,a)=>({...e,level:a+1})))}a.workflow_users=s,t({...a}),p({})};return e.workflowId?(0,N.jsxs)(s.A,{className:"shadow",children:[(0,N.jsx)(n.A,{children:"Workflow creator"}),(0,N.jsxs)(i.A,{children:[(0,N.jsxs)(d.A,{style:{alignItems:"center"},children:[(0,N.jsx)(h.A,{children:(0,N.jsxs)(l.A,{children:[(0,N.jsx)(o.A,{children:"User"}),(0,N.jsxs)(c.A,{className:"rounded",type:"select",onChange:e=>p({...f,id:e.target.value}),value:f.id||"",children:[(0,N.jsx)("option",{value:"",children:"---- NONE ----"}),b.map((e=>{let t=!1;return a.workflow_users&&a.workflow_users.forEach((a=>{a.userId===e.id&&(t=!0)})),t?null:(0,N.jsx)("option",{value:e.id,children:e.name},e.id)}))]})]})}),(0,N.jsx)(h.A,{children:(0,N.jsxs)(l.A,{children:[(0,N.jsx)(o.A,{children:"Type"}),(0,N.jsxs)(c.A,{className:"rounded",type:"select",onChange:e=>p({...f,type:e.target.value}),value:f.type||"",children:[(0,N.jsx)("option",{value:"",children:"---- NONE ----"}),(0,N.jsx)("option",{value:"recommender",children:"Recommender"}),(0,N.jsx)("option",{value:"approver",children:"Approver"})]})]})}),(0,N.jsx)(h.A,{children:(0,N.jsx)(u.A,{size:"sm",color:"info",onClick:()=>{f.id&&f.type?k("add",{userId:Number(f.id),type:f.type}):w.oR.warn("Both user & type should be selected!")},children:(0,N.jsx)("i",{className:"fa fa-plus text-white"})})})]}),(0,N.jsxs)(y.A,{responsive:!0,bordered:!0,hover:!0,className:"mt-2",children:[(0,N.jsx)("thead",{children:(0,N.jsxs)("tr",{children:[(0,N.jsx)("td",{children:"Level"}),(0,N.jsx)("td",{children:"Name"}),(0,N.jsx)("td",{children:"Type"}),(0,N.jsx)("td",{})]})}),(0,N.jsx)("tbody",{children:a.workflow_users?a.workflow_users.map(((e,a)=>(0,N.jsxs)("tr",{children:[(0,N.jsx)("td",{children:e.level}),(0,N.jsx)("td",{children:(0,j.w)(e.userId,b)}),(0,N.jsx)("td",{children:e.type.toUpperCase()}),(0,N.jsx)("td",{children:(0,N.jsx)(u.A,{size:"sm",color:"danger",onClick:()=>{k("delete",{index:a})},children:(0,N.jsx)("i",{className:"fa fa-trash text-white"})})})]},a))):null})]})]}),(0,N.jsx)(m.A,{children:(0,N.jsx)(u.A,{onClick:()=>{_().find(a.workflow_users||[],{type:"approver"})?(x(a),(0,g.KK)(a,((e,a)=>{e?w.oR.error("Error!"):w.oR.success("Success!")}))):w.oR.warn("Could not submit without selecting an approver")},color:"success",size:"sm",className:"float-right",children:"Submit"})})]}):null};var E=t(97508),I=t(57478),L=t(80231);const T=(0,E.Ng)((e=>({users:e.allFields.users})))((e=>{const a=v.parse(e.location.search),t=k.A.getId(a["?i"]),[b,y]=(0,r.useState)(!0),[g,j]=(0,r.useState)(!1),[A,_]=(0,r.useState)({}),[E,T]=(0,r.useState)([]);(0,r.useEffect)((()=>{(0,p.Rs)(t).then((e=>{_({...e}),T(e.formData),y(!1)}))}),[]);const R=async()=>(T(JSON.parse(E)),JSON.parse(E)),P=e=>{T(e.task_data)},S=()=>{(0,p.Lc)((()=>{switch(A.type){case"html":return{...A,formData:E};case"dynamic":return{...A,formData:JSON.stringify(E)};default:return A}})(),((e,a)=>{e?w.oR.error("Error!"):w.oR.success("Success")}))};return t?(0,N.jsxs)(N.Fragment,{children:[(0,N.jsxs)(s.A,{className:"shadow",children:[(0,N.jsxs)(n.A,{children:[(0,N.jsxs)(l.A,{children:[(0,N.jsx)(o.A,{children:"Name"}),(0,N.jsx)(c.A,{className:"rounded",onChange:e=>{let{target:{value:a}}=e;_({...A,name:a})},value:A.name||"",type:"text",name:"name",placeholder:"Name",required:!0})]}),(0,N.jsxs)(l.A,{children:[(0,N.jsx)(o.A,{children:"Description"}),(0,N.jsx)(c.A,{className:"rounded",onChange:e=>{let{target:{value:a}}=e;_({...A,description:a})},value:A.description||"",type:"textarea",name:"description",placeholder:"Description",required:!0})]}),g?(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(l.A,{check:!0,children:(0,N.jsxs)(o.A,{check:!0,children:[(0,N.jsx)(c.A,{className:"rounded",onChange:e=>{let{target:{checked:a}}=e;_({...A,isActive:a})},checked:A.isActive||!1,type:"checkbox",name:"isActive",required:!0}),"Active"]})}),(0,N.jsx)(l.A,{check:!0,children:(0,N.jsxs)(o.A,{check:!0,children:[(0,N.jsx)(c.A,{className:"rounded",onChange:e=>{let{target:{checked:a}}=e;_({...A,form_detail:{...A.form_detail,isForCustomer:a}})},checked:A.form_detail&&A.form_detail.isForCustomer||!1,type:"checkbox",required:!0}),(0,N.jsxs)("span",{children:["Check the box to make this form available to the customer. (",(0,N.jsx)("strong",{children:" WARNING "}),")"]})]})})]}):(0,N.jsx)("span",{className:"alert alert-warning",children:"You cannot activate the form without adding users to the workflow"})]}),b?(0,N.jsx)(i.A,{children:(0,N.jsx)("h1",{className:"blink_me",children:"Loading ..."})}):(0,N.jsxs)(i.A,{children:["html"===A.type?(0,N.jsxs)(d.A,{children:[(0,N.jsx)(h.A,{children:(0,N.jsx)(c.A,{style:{minHeight:400},type:"textarea",value:E,onChange:e=>{let{target:{value:a}}=e;T(a)}})}),(0,N.jsx)(h.A,{children:(0,N.jsx)(I.A,{formData:E})})]}):null,"dynamic"===A.type?(0,N.jsx)(f.Ay.ReactFormBuilder,{toolbarItems:x,onLoad:R,onPost:P}):null]}),(0,N.jsxs)(m.A,{className:"d-flex justify-content-end",children:[(0,N.jsx)(u.A,{onClick:()=>window.history.back(),type:"button",size:"sm",color:"info",className:"mx-2 text-white",children:"Cancel"}),(0,N.jsx)(u.A,{onClick:S,size:"sm",color:"success",children:"Submit"})]})]}),(0,N.jsx)(C,{setHasUser:j,workflowId:A.workflowId,users:e.users})]}):(e.history.push(L.A.formList),null)}))},48201:(e,a,t)=>{t.d(a,{Lc:()=>o,Rs:()=>c,Uq:()=>n,gG:()=>l,i6:()=>i});var r=t(76400);const s="/forms",n=e=>{r.E8.get(`${s}`).then((a=>{e(null,a.data)})).catch((a=>{e(a)}))},l=(e,a)=>{r.E8.post(`${s}`,e).then((e=>{a(null,e.data)})).catch((e=>{a(e)}))},o=(e,a)=>{r.E8.put(`${s}`,e).then((e=>a(null,e.data))).catch((e=>{a(e)}))},c=e=>r.E8.get(`${s}/${e}`).then((e=>e.data)),i=(e,a)=>{r.E8.delete(`${s}/${e}`).then((e=>a(null,e.data))).catch((e=>{a(e)}))}},57478:(e,a,t)=>{t.d(a,{A:()=>l});var r=t(65043),s=t(18039),n=t(70579);const l=e=>{const a=e.type||null,t=e.isEdit||!1,l=e.isEditBank||!1,o=e.memoValues||[],c=e.formData||"";return(0,r.useEffect)((()=>{switch(a){case s._H:break;case s.OK:const e=document.getElementById("bank-segment");e&&e.parentNode.removeChild(e)}o.forEach((e=>{let{name:a,value:r}=e;const s=document.getElementsByName(a);0!==s.length&&s.forEach((e=>{switch(console.log(t,l),t||l&&"bank-segment"===e.parentNode.id?e.setAttribute("name",a):(e.setAttribute("readonly","readonly"),e.removeAttribute("name")),e.type){case"checkbox":"true"===r?e.setAttribute("checked",!0):e.removeAttribute("checked");break;case"radio":JSON.stringify(e.value)===r&&e.setAttribute("checked",!0);break;default:const a=r.slice(1,-1);e.setAttribute("value",a),e.value=JSON.parse(r)}}))}))}),[o,t,a]),(0,n.jsx)("div",{id:"html-form-segment",className:"my-2",dangerouslySetInnerHTML:{__html:c}})}},68499:(e,a,t)=>{t.d(a,{Dn:()=>c,KK:()=>n,Mw:()=>l,QZ:()=>o});var r=t(76400);const s="/workflow",n=(e,a)=>{r.E8.put(`${s}/${e.id}`,e).then((e=>a(null,e.data))).catch((e=>a(e)))},l=(e,a)=>{r.E8.get(`${s}/${e}`).then((e=>a(null,e.data))).catch((e=>a(e)))},o=(e,a)=>{r.E8.get(`${s}/master/${e}`).then((e=>a(null,e.data))).catch((e=>a(e)))},c=(e,a)=>{r.E8.post(`${s}/submit/${e.action}`,e.data).then((e=>a(null,e.data))).catch((e=>a(e)))}},67735:(e,a,t)=>{t.d(a,{a:()=>l,w:()=>n});var r=t(68499),s=t(28096);const n=(e,a)=>{let t={};return a&&a.forEach((a=>{a.id===e&&(t=a)})),t.name||""},l=function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>{};(0,r.Dn)({action:"skip",data:{comment:"",workflowMasterId:e}},((e,t)=>{e?s.oR.error("Error!"):(s.oR.success("Success!"),a())}))}},58472:(e,a,t)=>{t.d(a,{A:()=>f});var r=t(58168),s=t(98587),n=t(65043),l=t(65173),o=t.n(l),c=t(98139),i=t.n(c),d=t(62373),h=["className","cssModule","size","bordered","borderless","striped","dark","hover","responsive","tag","responsiveTag","innerRef"],m={className:o().string,cssModule:o().object,size:o().string,bordered:o().bool,borderless:o().bool,striped:o().bool,dark:o().bool,hover:o().bool,responsive:o().oneOfType([o().bool,o().string]),tag:d.Wx,responsiveTag:d.Wx,innerRef:o().oneOfType([o().func,o().string,o().object])},u=function(e){var a=e.className,t=e.cssModule,l=e.size,o=e.bordered,c=e.borderless,m=e.striped,u=e.dark,f=e.hover,p=e.responsive,b=e.tag,x=e.responsiveTag,k=e.innerRef,w=(0,s.A)(e,h),v=(0,d.qO)(i()(a,"table",!!l&&"table-"+l,!!o&&"table-bordered",!!c&&"table-borderless",!!m&&"table-striped",!!u&&"table-dark",!!f&&"table-hover"),t),y=n.createElement(b,(0,r.A)({},w,{ref:k,className:v}));if(p){var g=(0,d.qO)(!0===p?"table-responsive":"table-responsive-"+p,t);return n.createElement(x,{className:g},y)}return y};u.propTypes=m,u.defaultProps={tag:"table",responsiveTag:"div"};const f=u}}]);
//# sourceMappingURL=4081.66a4ee0d.chunk.js.map