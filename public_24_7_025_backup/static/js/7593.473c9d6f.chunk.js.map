{"version":3,"file":"static/js/7593.473c9d6f.chunk.js","mappings":"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","sources":["admin/views/Departments/api.js","admin/views/SecurityHierarchy/AddHierarchy.js","admin/views/SecurityHierarchy/api.js"],"sourcesContent":["import { server } from \"admin/config/server\";\r\n\r\nconst URL = \"/department\";\r\n\r\nfunction getDepartments(callback) {\r\n  server\r\n    .get(`${URL}`)\r\n    .then((response) => {\r\n      callback(null, response.data);\r\n    })\r\n    .catch((err) => {\r\n      callback(err);\r\n    });\r\n}\r\n\r\nfunction getDepartment(id, callback) {\r\n  server\r\n    .get(`${URL}/${id}`)\r\n    .then((response) => {\r\n      callback(null, response.data);\r\n    })\r\n    .catch((err) => {\r\n      callback(err);\r\n    });\r\n}\r\n\r\nfunction addDepartment(body, callback) {\r\n  server\r\n    .post(`${URL}`, body)\r\n    .then((response) => {\r\n      callback(null, response.data);\r\n    })\r\n    .catch((err) => {\r\n      callback(err);\r\n    });\r\n}\r\n\r\nfunction editDepartment(body, callback) {\r\n  server\r\n    .put(`${URL}`, body)\r\n    .then((response) => {\r\n      callback(null, response.data);\r\n    })\r\n    .catch((err) => {\r\n      callback(err);\r\n    });\r\n}\r\n\r\nfunction deleteDepartment(id, callback) {\r\n  server\r\n    .delete(`${URL}/${id}`)\r\n    .then((response) => {\r\n      callback(null, response.data);\r\n    })\r\n    .catch((err) => {\r\n      callback(err);\r\n    });\r\n}\r\n\r\nexport { getDepartment, getDepartments, addDepartment, editDepartment, deleteDepartment };\r\n","import React from \"react\";\r\nimport { addSecurityHierarchy, getFilterBranch, getFilterDepartment } from \"./api\";\r\nimport { getFormData } from \"config/form\";\r\nimport { loadAllFields } from \"redux/actions/apiAction\";\r\nimport { connect } from \"react-redux\";\r\nimport { toast } from \"react-toastify\";\r\nimport metaRoutes from \"config/meta_routes\";\r\nimport CustomCancel from \"admin/components/CustomCancel\";\r\nimport CustomSubmit from \"admin/components/CustomSubmit\";\r\nimport { Card, CardBody, CardHeader, Row, Col, CardFooter, Label, Input, FormGroup, Form } from \"reactstrap\";\r\nimport { getDepartments } from \"../Departments/api\";\r\nimport Select from \"react-select\";\r\nclass AddHierarchy extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.handleSubmit = this.handleSubmit.bind(this);\r\n    this.state = {\r\n      branches: [],\r\n      hierarchy: [],\r\n      branchSelect: [],\r\n      departmentSelect: [],\r\n      branchSelectedOptions: [],\r\n      departmentSelectedOptions: [],\r\n      filterBranch: [],\r\n      filterDepartment: [],\r\n      provinceUnit: \"\",\r\n      hierarchyName: \"\",\r\n      departmentAndNameToggle: false,\r\n      departments: [],\r\n      departmentValue: \"\",\r\n      departmentName: \"\",\r\n      findUnitOrDept: \"\",\r\n      toggleBranchAndDepartmentOption: false,\r\n      parentList: []\r\n    };\r\n  }\r\n\r\n  componentDidMount() {\r\n    // const securityHierarchy = this.props.allFields.map();\r\n    this.setState(this.props.allFields, () => {\r\n      const select = [];\r\n      const departmentSelect = [];\r\n      // this.state.branches.forEach((item) => {\r\n      //   const value = { value: item.id, label: item.name };\r\n      //   select.push(value);\r\n      // });\r\n      this.setState({\r\n        filterBranch: getFilterBranch((err, data) => {\r\n          if (!err) {\r\n            data.forEach((item) => {\r\n              const value = { value: item.id, label: item.name };\r\n              select.push(value);\r\n            });\r\n          }\r\n        }),\r\n        // store values from api to a state\r\n        filterDepartment: getFilterDepartment((err, data) => {\r\n          if (!err) {\r\n            data.forEach((item) => {\r\n              const value = { value: item.id, label: item.name };\r\n              departmentSelect.push(value);\r\n            });\r\n          }\r\n        }),\r\n      });\r\n      getDepartments((err, departments) => {\r\n        if (err) return;\r\n        this.setState(\r\n          {\r\n            parentList: departments\r\n          }\r\n        );\r\n      });\r\n\r\n      this.setState({\r\n        branchSelect: select,\r\n        departmentSelect: departmentSelect,\r\n      });\r\n    });\r\n  }\r\n\r\n  MultiSelectChange = (value, { action, removedValue }) => {\r\n    switch (action) {\r\n      case \"remove-value\":\r\n        break;\r\n      case \"pop-value\":\r\n        if (removedValue && removedValue.isFixed) {\r\n          return;\r\n        }\r\n        break;\r\n      case \"clear\":\r\n        value = this.state.branchSelect.filter((v) => v.isFixed);\r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n    this.setState({ branchSelectedOptions: value });\r\n  };\r\n\r\n  // multi select in case for department\r\n  departmentMultiSelectChange = (value, { action, removedValue }) => {\r\n    switch (action) {\r\n      case \"remove-value\":\r\n        break;\r\n      case \"pop-value\":\r\n        if (removedValue && removedValue.isFixed) {\r\n          return;\r\n        }\r\n        break;\r\n      case \"clear\":\r\n        value = this.state.departmentSelect.filter((v) => v.isFixed);\r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n    this.setState({ departmentSelectedOptions: value });\r\n  };\r\n\r\n  handleSubmit = (event) => {\r\n    event.preventDefault();\r\n    let formData = getFormData(event);\r\n\r\n    // for filtering hirarchy\r\n    const parent = this.state.hierarchy.find((item) => item.id == formData.parentId);\r\n\r\n    // for parent selection +1 for making hierarchy below parent hierarchy\r\n    if (parent) {\r\n      formData.level = parent.level + 1;\r\n    } else {\r\n      formData.level = 0;\r\n    }\r\n    // for department insert\r\n    if (this.state.departmentValue) {\r\n      if (this.state.findUnitOrDept == \"Unit_\") {\r\n        formData.name = `Unit${this.state.hierarchyName ? \"_\" + this.state.hierarchyName.replace(/ /g, \"\") : \"\"}${this.state.departmentName ? \"_\" + this.state.departmentName : \"\"\r\n          }`;\r\n        formData.type = \"unit\";\r\n      } else {\r\n        formData.type = \"department\";\r\n        formData.name = \"Dept_\" + this.state.departmentName;\r\n      }\r\n    }\r\n\r\n    //for branch insent\r\n    if (this.state.branchSelectedOptions && this.state.branchSelectedOptions.length > 0) {\r\n      formData = {\r\n        branchData: this.state.branchSelectedOptions,\r\n        level: formData.level,\r\n        parentId: formData.parentId,\r\n        type: \"branch\",\r\n      };\r\n    }\r\n    if (this.state.departmentSelectedOptions && this.state.departmentSelectedOptions.length > 0) {\r\n      formData = {\r\n        name: `Unit${this.state.hierarchyName ? \"_\" + this.state.hierarchyName.replace(/ /g, \"\") : \"\"}${this.state.departmentName ? \"_\" + this.state.departmentName : \"\"\r\n          }`,\r\n        code: \"unit_\" + this.state.departmentValue,\r\n        multipleHierarchy: true,\r\n        departmentId: this.state.departmentValue,\r\n        departmentData: this.state.departmentSelectedOptions,\r\n        level: formData.level,\r\n        parentId: formData.parentId,\r\n        type: \"unit\",\r\n      };\r\n    }\r\n    addSecurityHierarchy(formData, (err, data) => {\r\n      if (err || !data.success) {\r\n        toast.error(data?.message || \"Error\");\r\n      } else {\r\n        toast.success(data?.message || \"Successful\");\r\n        this.props.history.push(metaRoutes.adminSecurityHierarchy);\r\n        this.props.dispatch(loadAllFields());\r\n      }\r\n    });\r\n  };\r\n\r\n  handleProvinceunitChange = (e) => {\r\n    this.setState({\r\n      provinceUnit: e.target.value,\r\n      departmentAndNameToggle: false,\r\n      hierarchyName: \"\",\r\n      departmentValue: \"\",\r\n      departmentName: \"\",\r\n    });\r\n\r\n    let value;\r\n    if (e.target.value == \"Dept_\") {\r\n      value = \"Dept_\";\r\n    } else {\r\n      value = \"Unit_\";\r\n    }\r\n\r\n    this.setState({\r\n      departmentAndNameToggle: true,\r\n      findUnitOrDept: value,\r\n    });\r\n\r\n    // checked Department then departmentAndNameToggle is true\r\n    if (e.target.value == \"Dept_\" || e.target.value == \"Unit_\") {\r\n      this.setState({\r\n        departmentAndNameToggle: true,\r\n      });\r\n    }\r\n  };\r\n\r\n  handleNameChange = (e) => {\r\n    this.setState({\r\n      hierarchyName: e.target.value,\r\n    });\r\n  };\r\n\r\n  handleChangeUnitDepartment = (e) => {\r\n    this.setState({\r\n      departmentValue: e.target.value,\r\n      departmentName: e.target.value,\r\n    });\r\n  };\r\n\r\n  handleDepartmentChange = (e) => {\r\n    const department = this.state.parentList.find((dept) => dept.id == e.target.value);\r\n    this.setState({\r\n      departmentValue: e.target.value,\r\n      departmentName: department.name,\r\n    });\r\n  };\r\n  handleBranchAndDepartment = (e) => {\r\n    const getBranchList = this.state.hierarchy.filter((branch) => (branch.branchId ? parseInt(branch.branchId) : null));\r\n    const targetValue = parseInt(e.target.value);\r\n    const filterBranchId = getBranchList.map((ele) => parseInt(ele.id));\r\n    if (filterBranchId.includes(targetValue)) {\r\n      this.setState({\r\n        toggleBranchAndDepartmentOption: !this.state.toggleBranchAndDepartmentOption,\r\n      });\r\n    } else {\r\n      this.setState({\r\n        toggleBranchAndDepartmentOption: false,\r\n      });\r\n    }\r\n    return;\r\n  };\r\n  renderItems() {\r\n    // filter department where departmentId is not null\r\n    const hasDepartmentId = this.state.hierarchy.filter((dept) => dept.departmentId != null);\r\n\r\n    const isUnit = this.state.findUnitOrDept == \"Unit_\";\r\n    let code = `${this.state.provinceUnit}${this.state.departmentValue}${this.state.hierarchyName ? \"_\" + this.state.hierarchyName.replace(/ /g, \"\") : \"\"\r\n      }`;\r\n    const department = this.state.departmentSelect;\r\n    const branch = this.state.branchSelect;\r\n\r\n    return (\r\n      <Card className=\"shadow\">\r\n        <CardHeader>\r\n          <Row>\r\n            <Col>\r\n              <i className=\"fas fa-sitemap mr-1\" />\r\n              Add Security Hierarchy\r\n            </Col>\r\n          </Row>\r\n        </CardHeader>\r\n        <Form onSubmit={this.handleSubmit}>\r\n          <CardBody>\r\n            <Row>\r\n              <Col>\r\n                <>\r\n                  <FormGroup>\r\n                    <Row>\r\n                      <Col md={4}>\r\n                        <Label>\r\n                          Parent Group\r\n                          <span className=\"text-danger h6 ml-1\">\r\n                            <b>*</b>\r\n                          </span>\r\n                        </Label>\r\n                      </Col>\r\n                      <Col md={8}>\r\n                        <Input\r\n                          type=\"select\"\r\n                          name=\"parentId\"\r\n                          id=\"parentId\"\r\n                          required\r\n                          onClick={(e) => this.handleBranchAndDepartment(e)}\r\n                        >\r\n                          <option value=\"\">--- NONE ---</option>\r\n                          {this.state.hierarchy.map((row) => {\r\n                            let padding = \"\";\r\n                            let level = row.level;\r\n                            while (level-- > 0) {\r\n                              padding += \"---\";\r\n                            }\r\n\r\n                            return (\r\n                              <option key={row.id} value={row.id}>\r\n                                {padding + \" \" + row.name}\r\n                              </option>\r\n                            );\r\n                          })}\r\n                        </Input>\r\n                      </Col>\r\n                    </Row>\r\n                  </FormGroup>\r\n                  {this.state?.provinceUnit == \"\" && (\r\n                    <FormGroup>\r\n                      <Row>\r\n                        <Col md={4}>\r\n                          <Label>Branch</Label>\r\n                        </Col>\r\n                        <Col md={8}>\r\n                          <Select\r\n                            isMulti\r\n                            onChange={this.MultiSelectChange}\r\n                            value={this.state.branchSelectedOptions}\r\n                            name=\"branchList\"\r\n                            options={this.state.branchSelect}\r\n                            className=\"basic-multi-select react-select-style\"\r\n                            classNamePrefix=\"select\"\r\n                            isDisabled={this.disabled}\r\n                          />\r\n                        </Col>\r\n                      </Row>\r\n                    </FormGroup>\r\n\r\n                  )}\r\n                </>\r\n              </Col>\r\n\r\n              {/* \r\n              <Col>\r\n                {!this.state?.branchSelectedOptions?.length > 0 && (\r\n                  <>\r\n                    <FormGroup>\r\n                      <Row>\r\n                        <Col md={4}>\r\n                          <Label>\r\n                            Department\r\n                            <span className=\"text-danger h6 ml-1\">\r\n                              <b>*</b>\r\n                            </span>\r\n                          </Label>\r\n                        </Col>\r\n                        <Col md={8}>\r\n                          <Input\r\n                            type=\"select\"\r\n                            name=\"provinceUnit\"\r\n                            required\r\n                            id=\"provinceUnit\"\r\n                            onChange={this.handleProvinceunitChange}\r\n                          >\r\n                            <option value=\"\">--- NONE ---</option>\r\n                            {!this.state.toggleBranchAndDepartmentOption && <option value=\"Dept_\">Department</option>}\r\n                          </Input>\r\n                        </Col>\r\n                      </Row>\r\n                    </FormGroup>\r\n                    {isUnit && (\r\n                      <div className=\"alert alert-dark\" role=\"alert\">\r\n                        Please select department hierarchy\r\n                      </div>\r\n                    )}\r\n                    {this.state.departmentAndNameToggle ? (\r\n                      <FormGroup>\r\n                        <Row>\r\n                          <Col md={4}>\r\n                            <Label>Departments</Label>\r\n                            <span className=\"text-danger h6 ml-1\">\r\n                              <b>*</b>\r\n                            </span>\r\n                          </Col>\r\n                          <Col md={8}>\r\n                            <Input\r\n                              type=\"select\"\r\n                              required\r\n                              name=\"department\"\r\n                              onChange={isUnit ? this.handleChangeUnitDepartment : this.handleDepartmentChange}\r\n                            >\r\n                              <option value=\"\">--- NONE ---</option>\r\n\r\n                              {isUnit\r\n                                ? hasDepartmentId.map((row) => {\r\n                                  let padding = \"\";\r\n                                  let level = row.level;\r\n                                  while (level-- > 0) {\r\n                                    padding += \"---\";\r\n                                  }\r\n                                  return (\r\n                                    <option key={row.id} value={row.id}>\r\n                                      {padding + \" \" + row.name}\r\n                                    </option>\r\n                                  );\r\n                                })\r\n                                : this.state.departments.map((row) => {\r\n                                  let padding = \"\";\r\n                                  let level = row.level;\r\n                                  while (level-- > 0) {\r\n                                    padding += \"---\";\r\n                                  }\r\n                                  return (\r\n                                    <option key={row.id} value={row.id} name=\"\">\r\n                                      {padding + \" \" + row.name}\r\n                                    </option>\r\n                                  );\r\n                                })}\r\n                            </Input>\r\n                          </Col>\r\n                        </Row>\r\n                      </FormGroup>\r\n                    ) : null}\r\n                    {this.state.departmentAndNameToggle ? (\r\n                      <>\r\n                        <FormGroup>\r\n                          <Row>\r\n                            <Col md={4}>\r\n                              <Label>Name</Label>{\" \"}\r\n                              {isUnit && (\r\n                                <span className=\"text-danger h6 ml-1\">\r\n                                  <b>*</b>\r\n                                </span>\r\n                              )}{\" \"}\r\n                            </Col>\r\n                            <Col md={8}>\r\n                              <Input required={isUnit} name=\"name\" id=\"name\" onChange={this.handleNameChange} />\r\n                            </Col>\r\n                          </Row>\r\n                        </FormGroup>\r\n                      </>\r\n                    ) : null}\r\n                  </>\r\n                )}\r\n\r\n                <FormGroup>\r\n                  <Row>\r\n                    <Col md={4}>\r\n                      <Label>Hierarchy Code</Label>\r\n                    </Col>\r\n                    <Col md={8}>\r\n                      <Input name=\"code\" id=\"code\" value={code == \"_\" ? \"\" : code} disabled />\r\n                    </Col>\r\n                  </Row>\r\n                </FormGroup>\r\n              </Col>\r\n              */}\r\n            </Row>{\" \"}\r\n          </CardBody>\r\n          <CardFooter className=\"d-flex justify-content-end\">\r\n            <CustomCancel onClick={() => window.history.back()} />\r\n            <CustomSubmit />\r\n          </CardFooter>\r\n        </Form>\r\n      </Card>\r\n    );\r\n  }\r\n\r\n  render() {\r\n    return this.renderItems();\r\n  }\r\n}\r\n\r\nexport default connect((state) => ({ allFields: state.allFields }))(AddHierarchy);\r\n","import { server } from \"admin/config/server\";\r\n\r\nconst URL = \"/security-hierarchy\";\r\nconst filterBranchURL = \"/branchesFilter\";\r\nconst filterDepartmentURL = \"/departmentsFilter\";\r\nconst securityHierarchyBranches = \"/security-hierarchy-branches\"\r\n\r\nexport const getSecurityHierarchy = (callback) => {\r\n  server\r\n    .get(`${URL}`)\r\n    .then((response) => {\r\n      callback(null, response.data);\r\n    })\r\n    .catch((err) => {\r\n      callback(err);\r\n    });\r\n};\r\n\r\nexport const getSecurityHierarchyBranches = (callback) => {\r\n  server\r\n    .get(`${securityHierarchyBranches}`)\r\n    .then((response) => {\r\n      callback(null, response.data);\r\n    })\r\n    .catch((err) => {\r\n      callback(err);\r\n    });\r\n};\r\n\r\n\r\n\r\nexport const getOneHierarchy = (id, callback) => {\r\n  server\r\n    .get(`${URL}/${id}`)\r\n    .then((response) => {\r\n      callback(null, response.data);\r\n    })\r\n    .catch((err) => {\r\n      callback(err);\r\n    });\r\n};\r\n\r\nexport const addSecurityHierarchy = (data, callback) => {\r\n  server\r\n    .post(`${URL}`, data)\r\n    .then((response) => {\r\n      console.log(response.data);\r\n      callback(null, response.data);\r\n    })\r\n    .catch((err) => {\r\n      callback(err);\r\n    });\r\n};\r\n\r\nexport const getFilterBranch = (callback) => {\r\n  server\r\n    .get(`${filterBranchURL}`)\r\n    .then((response) => {\r\n      callback(null, response.data);\r\n    })\r\n    .catch((err) => {\r\n      callback(err);\r\n    });\r\n};\r\nexport const getFilterDepartment = (callback) => {\r\n  server\r\n    .get(`${filterDepartmentURL}`)\r\n    .then((response) => {\r\n      callback(null, response.data);\r\n    })\r\n    .catch((err) => {\r\n      callback(err);\r\n    });\r\n};\r\n\r\nexport const editHierarchy = (body, callback) => {\r\n  server\r\n    .put(`${URL}`, body)\r\n    .then((response) => {\r\n      callback(null, response.data);\r\n    })\r\n    .catch((err) => {\r\n      callback(err);\r\n    });\r\n};\r\n\r\nexport const deleteHierarchy = (id, callback) => {\r\n  server\r\n    .delete(`${URL}/${id}`)\r\n    .then((response) => {\r\n      callback(null, response.data);\r\n    })\r\n    .catch((err) => {\r\n      callback(err);\r\n    });\r\n};\r\n"],"names":["URL","getDepartments","callback","server","get","then","response","data","catch","err","getDepartment","id","addDepartment","body","post","editDepartment","put","deleteDepartment","delete","AddHierarchy","React","constructor","props","super","MultiSelectChange","value","_ref","action","removedValue","isFixed","this","state","branchSelect","filter","v","setState","branchSelectedOptions","departmentMultiSelectChange","_ref2","departmentSelect","departmentSelectedOptions","handleSubmit","event","preventDefault","formData","getFormData","parent","hierarchy","find","item","parentId","level","departmentValue","findUnitOrDept","name","hierarchyName","replace","departmentName","type","length","branchData","code","multipleHierarchy","departmentId","departmentData","addSecurityHierarchy","success","toast","error","message","history","push","metaRoutes","adminSecurityHierarchy","dispatch","loadAllFields","handleProvinceunitChange","e","provinceUnit","target","departmentAndNameToggle","handleNameChange","handleChangeUnitDepartment","handleDepartmentChange","department","parentList","dept","handleBranchAndDepartment","getBranchList","branch","branchId","parseInt","targetValue","map","ele","includes","toggleBranchAndDepartmentOption","bind","branches","filterBranch","filterDepartment","departments","componentDidMount","allFields","select","getFilterBranch","forEach","label","getFilterDepartment","renderItems","_this$state","_jsxs","Card","className","children","_jsx","CardHeader","Row","Col","Form","onSubmit","CardBody","_Fragment","FormGroup","md","Label","Input","required","onClick","row","padding","Select","isMulti","onChange","options","classNamePrefix","isDisabled","disabled","CardFooter","CustomCancel","window","back","CustomSubmit","render","connect","getSecurityHierarchy","getSecurityHierarchyBranches","getOneHierarchy","console","log","editHierarchy","deleteHierarchy"],"sourceRoot":""}